!function(){function e(e,t,r,a,n,o,i){try{var s=e[o](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function t(t){return function(){var r=this,a=arguments;return new Promise((function(n,o){var i=t.apply(r,a);function s(t){e(i,n,o,s,l,"next",t)}function l(t){e(i,n,o,s,l,"throw",t)}s(void 0)}))}}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function a(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}System.register(["./app-legacy.CVtZXpP_.js"],(function(e,r){"use strict";var o,i,s,l,d,u,c,g,m,_,p,E,y,v,h,P,A,I,S,D,R,N,b,T,O,f,C,M,G,w,L,H,Y,U,k,B,V,x,z,F,q,j,Z,Q,$,W,X,J,K,ee,te,re,ae,ne,oe,ie,se,le,de,ue,ce,ge,me,_e,pe,Ee,ye,ve,he,Pe,Ae,Ie,Se,De,Re,Ne,be,Te,Oe,fe,Ce,Me,Ge,we,Le,He,Ye,Ue,ke,Be,Ve,xe,ze,Fe,qe,je,Ze,Qe,$e,We,Xe,Je,Ke,et,tt;return{setters:[e=>{o=e.lR,i=e.lS,s=e.id,l=e.lT,d=e.lU,u=e.jh,c=e.lV,g=e.lW,m=e.bA,_=e.lX,p=e.lY,E=e.lZ,y=e.i,v=e.k,h=e.iM,P=e.cl,A=e.h4,I=e.l_,S=e.dX,D=e.iL,R=e.gM,N=e.l$,b=e.gP,T=e.aN,O=e.iE,f=e.hk,C=e.bG,M=e.z,G=e.hl,w=e.hr,L=e.m0,H=e.m1,Y=e.m2,U=e.m3,k=e.m4,B=e.m5,V=e.m6,x=e.m7,z=e.m8,F=e.m9,q=e.ma,j=e.mb,Z=e.mc,Q=e.md,$=e.me,W=e.mf,X=e.mg,J=e.mh,K=e.mi,ee=e.mj,te=e.j,re=e.mk,ae=e.n,ne=e.ml,oe=e._,ie=e.a9,se=e.iQ,le=e.mm,de=e.iS,ue=e.D,ce=e.mn,ge=e.ht,me=e.iN,_e=e.mo,pe=e.mp,Ee=e.mq,ye=e.mr,ve=e.ms,he=e.bw,Pe=e.mt,Ae=e.mu,Ie=e.aP,Se=e.mv,De=e.fx,Re=e.mw,Ne=e.mx,be=e.my,Te=e.mz,Oe=e.iU,fe=e.mA,Ce=e.ir,Me=e.hp,Ge=e.iW,we=e.i$,Le=e.j1,He=e.aM,Ye=e.iT,Ue=e.hG,ke=e.iP,Be=e.mB,Ve=e.mC,xe=e.mD,ze=e.mE,Fe=e.j2,qe=e.mF,je=e.mG,Ze=e.b2,Qe=e.a,$e=e.j5,We=e.j4,Xe=e.T,Je=e.aT,Ke=e.R,et=e.cQ,tt=e.j3}],execute:function(){var r=document.createElement("style");r.textContent=".QIbE6{display:none}\n/*$vite$:1*/",document.head.appendChild(r),e("default",(function({asPaymentMethod:e=!1}){const r=He(null),n=b(null),{isScrimOpen:o,closePopupWindowsAndScrim:i}=Ye({endpoint:n,invokingWallet:"GOOGLE_PAY"}),s=Ue(),l=mt(),d=h("GOOGLE_PAY"),[O]=re(),{value:L}=he(),H=He({abortController:Mt(),initiallySelectedShippingOptionId:void 0}),{inMemoryGooglePayParts:{sdkStatus:k,buttonStatus:B}}=C(),{markAsLoaded:V}=ke(),F=He(!0),q=ue(Be),j=He(!1),Z=function({asPaymentMethod:e}){const t=A(),r=mt(),n=function(){const e=P(),t=h("GOOGLE_PAY"),{allowedAuthMethods:r,allowedCardNetworks:a,gateway:n,gatewayMerchantId:o}=t||{},i=v((()=>[{type:"CARD",parameters:{allowedAuthMethods:r,allowedCardNetworks:a,billingAddressRequired:!0,billingAddressParameters:{format:"FULL",phoneNumberRequired:e.isRequired("phone")}},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:null!=n?n:"",gatewayMerchantId:null!=o?o:""}}}]),[e,r,a,n,o]);return void 0===t?[]:i}(),{shippingCountries:o}=I(),i=P(),s=S().shippingRequired&&!e,l=D(),d=gt(),{i18n:c,telemetryClient:g,source:m}=y(),_=v((()=>["PAYMENT_AUTHORIZATION",...s?["SHIPPING_ADDRESS","SHIPPING_OPTION"]:[]]),[s]),p=R((()=>N(t))).value,E=b(null);return T((()=>{var e;if(0===n.length||!r||!o||0===(null==o?void 0:o.length)&&s||null==p.paymentDue||null==p.subtotal)return g.leaveErrorBreadcrumb("[GooglePay] useCreatePaymentDataRequest returning null - missing required data",{allowedPaymentMethodsCount:n.length,hasMerchantInfo:Boolean(r),hasShippingCountries:Boolean(o),shippingCountriesCount:(null==o?void 0:o.length)||0,isShippingRequired:s,hasPaymentDue:Boolean(p.paymentDue),hasSubtotal:Boolean(p.subtotal)}),void(E.value=null);const t=o.map((e=>e.value)),y=Boolean(null===(e=u({deferredTotal:p.deferredTotal,checkoutTotal:p.checkoutTotal,paymentFlexibilityPaymentTermsTemplate:p.paymentFlexibilityPaymentTermsTemplate}))||void 0===e?void 0:e.amount);g.leaveErrorBreadcrumb("[GooglePay] useCreatePaymentDataRequest creating payment data request",{hasPayableDeposit:y,isShippingRequired:s,emailRequired:l,allowedCountryCodesCount:t.length,callbackIntentsCount:_.length}),E.value=a(a({},rt),{},{allowedPaymentMethods:n,merchantInfo:r,callbackIntents:_,emailRequired:l,shippingAddressParameters:{allowedCountryCodes:t,phoneNumberRequired:i.isRequired("phone")},shippingAddressRequired:s,shippingOptionRequired:s,transactionInfo:dt(a(a({labels:d,i18nCurrency:c.currency},p),{},{hasPayableDeposit:y,googlePayTransactionId:m.sourceId}))})}),[i,n,_,l,s,c,d,r,o,g,p,E,m]),E}({asPaymentMethod:e}),Q=He(null),{i18n:$,telemetryClient:W,wallets:X,client:{userAgent:J}}=y(),K=e?$.translate("wallets.call_to_action",{walletName:""}):void 0,ee=$.translate("brand.google_pay"),ne="Chrome"===fe(J).name,nt="Android"===Ve(J),ot=xe()&&!ze(),It=function({endpoint:e,color:r,config:a,merchantInfo:n,buttonLabel:o,ariaLabel:i,markAsLoaded:s,sdkStatus:l,sdkStatusRef:d,buttonStatus:u,paymentDataRequest:c,containerRef:g,telemetryClient:m,asPaymentMethod:_,isFirstRender:p,updateSdkStatus:E,connectedNullPaymentDataRequest:y,shouldUpdateOnNullPaymentDataRequest:v}){return M(function(){var h=t((function*(t){m.leaveErrorBreadcrumb("[GooglePay] useOnConnect starting configuration"),v&&null===c.value&&(y.current=!0),e.value=t;const h=yield t.call.configure({isDark:"dark"===r,environment:null==a?void 0:a.environment,merchantInfo:n,buttonLabel:o,ariaLabel:i,paymentDataRequest:c.value,style:{borderRadius:we(g.current)}});p.current=!1,s(),h.status===Le.Success?(m.leaveErrorBreadcrumb("[GooglePay] useOnConnect configuration successful"),E({status:"available"},l,d),"error"!==u.value.status&&(u.value={status:"rendered"},m.counter({name:"checkout_wallet_button_rendered",value:1,attributes:{wallet_name:_t,status:"success",isPaymentMethodFlow:_}}))):(m.leaveErrorBreadcrumb("[GooglePay] useOnConnect configuration failed",{status:h.status}),h.status===Le.Error&&function({result:{type:e,name:t,message:r},telemetryClient:a}){"createButton"===e&&a.error(new ht(r,{cause:{name:t,message:r}}),{metadata:{additionalKey:{name:t,message:r}}})}({result:h,telemetryClient:m}),u.value={status:"error"},m.counter({name:"checkout_wallet_button_rendered",value:1,attributes:{wallet_name:_t,status:"error",isPaymentMethodFlow:_,reason:h.status===Le.ScriptLoadError?"script_load_error":"sandbox_error"}}),E({status:"error"},l,d))}));return function(e){return h.apply(this,arguments)}}(),[e,r,null==a?void 0:a.environment,n,o,i,s,l,d,u,c,g,m,_,p,E,y,v])}({endpoint:n,color:s,config:d,merchantInfo:l,buttonLabel:K,ariaLabel:ee,markAsLoaded:V,sdkStatus:k,sdkStatusRef:r,buttonStatus:B,paymentDataRequest:Z,containerRef:Q,telemetryClient:W,asPaymentMethod:e,isFirstRender:F,updateSdkStatus:Ct,connectedNullPaymentDataRequest:j,shouldUpdateOnNullPaymentDataRequest:q}),Rt=function({paymentDataRequest:e,asPaymentMethod:r,isScrimOpen:a,containerRef:n,endpoint:o}){const i=Oe(),{negotiate:s}=oe(),{telemetryClient:l,wallets:d,client:{userAgent:u}}=y(),c="Safari"===fe(u).name,g=b(!1),{inMemoryGooglePayParts:{paymentSheetError:m,paymentSheetOpenPromise:_,paymentSheetOpenPromiseResolve:p,sdkStatus:E},persistedGooglePaySignal:v}=C(),h=f(G.GooglePay),P=Ce(G.GooglePay),A=Me(G.GooglePay);return M(t((function*(){l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick"),i(n);try{if(r){if(g.value)return void l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick early return - already validating");var t;g.value=!0,c&&(l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick early return for Safari - updating validation lock to success"),null===(t=o.value)||void 0===t||t.call.updateValidationLock({status:"success"}),a.value=!0),yield new Promise(((e,t)=>{l.leaveErrorBreadcrumb("[GooglePay] useHandleClick starting negotiation for asPaymentMethod"),s({runListenersOnError:!0,onComplete:r=>{l.leaveErrorBreadcrumb("[GooglePay] useHandleClick negotiation complete",{status:null==r?void 0:r.status}),"success"===(null==r?void 0:r.status)?e():t()}})}))}var u;if(a.value=!0,d.activeSession)return l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick early return - active session exists"),l.log("handle_click_active_session_exists","Google Pay button clicked but active session already exists"),a.value=!1,void(null===(u=o.value)||void 0===u||u.call.updateValidationLock({status:"failure"}));const n=E.peek();var y;if("available"!==(null==n?void 0:n.status))return l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick early return - SDK not available",{sdkStatus:null==n?void 0:n.status}),l.log("handle_click_sdk_not_available","Google Pay button clicked but SDK is not available",{sdkStatus:null==n?void 0:n.status}),a.value=!1,void(null===(y=o.value)||void 0===y||y.call.updateValidationLock({status:"failure"}));d.setActiveSession({newValue:"GOOGLE_PAY",asPaymentMethod:r});try{var I;P();const t=e.value;var S;if(null===t||null==t.callbackIntents||0===t.callbackIntents.length)return l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick early return - invalid payment data request",{paymentDataRequest:null===t?"null":"invalid"}),d.clearActiveSession({invokingWallet:"GOOGLE_PAY"}),m.value={type:"config_missing_required_fields"},a.value=!1,void(null===(S=o.value)||void 0===S||S.call.updateValidationLock({status:"failure"}));A(),h(w.Success,r?Ge.PaymentMethod:Ge.Express),l.counter({name:"wallet_sheet_clicked",value:1,attributes:{instrument:G.GooglePay}}),v.value={initialCurrencyCode:t.transactionInfo.currencyCode},l.log("handle_click_button_clicked","Google Pay button clicked",{allowedAuthMethods:t.allowedPaymentMethods.map((e=>e.parameters.allowedAuthMethods))}),_.value=new Promise((e=>{p.value=e})),l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick finished",{result:"success"}),null===(I=o.value)||void 0===I||I.call.updateValidationLock({status:"success"})}catch(N){throw d.clearActiveSession({invokingWallet:"GOOGLE_PAY"}),a.value=!1,N}}catch(N){var D,R;l.leaveErrorBreadcrumb("[GooglePay] useHandleClick onClick error handling",{error:N}),c&&r?(null===(R=o.value)||void 0===R||R.call.closePopupWindows(),a.value=!1):r&&c||(a.value=!1),null===(D=o.value)||void 0===D||D.call.updateValidationLock({status:"failure"})}finally{g.value&&(g.value=!1)}})),[r,n,i,A,P,o,c,a,g,s,e,m,_,p,v,E,l,h,d])}({paymentDataRequest:Z,asPaymentMethod:e,isScrimOpen:o,containerRef:Q,endpoint:n}),Gt=function(e){const t=f(G.GooglePay),r=b(!1),{persistedGooglePaySignal:a,inMemoryGooglePayParts:{sdkStatus:n,buttonStatus:o,paymentSheetError:i,paymentSheetOpenPromiseResolve:s,paymentSheetOpenPromise:l}}=C(),{telemetryClient:d,wallets:u}=y();return M((c=>{var g;d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler onResponse",{response:c}),e.value=!1;const{response:m,error:_}=c;if(m)s.value(void 0);else if(_){var p;switch("CANCELED"===_.name?d.counter({name:"wallet_sheet_cancelled",value:1,attributes:{instrument:G.GooglePay}}):d.counter({name:"wallet_sheet_failed",value:1,attributes:{instrument:G.GooglePay}}),_.name){case"CANCELED":d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: CANCELED"),t(w.Cancelled);break;case"DEVELOPER_ERROR":d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: DEVELOPER_ERROR",{errorMessage:_.message}),t(w.Failure),i.value={type:"invalid_config"},d.error(new Pt(`loadPaymentData failed: ${_.message}`,{groupingHash:"GooglePayDeveloperError::LoadPaymentDataFailed"}));break;case"BUYER_ACCOUNT_ERROR":case"MERCHANT_ACCOUNT_ERROR":d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: ACCOUNT_ERROR",{errorType:_.name,errorMessage:_.message}),t(w.Failure),o.value={status:"error"},n.value={status:"error"},d.log("google_pay_response_handler_session_unavailable","Google Pay is unavailable for this session",{reason:_.name});break;case"INTERNAL_ERROR":d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: INTERNAL_ERROR",{errorMessage:_.message}),t(w.Failure),i.value={type:"unexpected_terminal_error"},d.log("google_pay_response_handler_internal_error","Google Pay internal server error occurred",{errorMessage:_.message});break;case yt:d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: VALIDATION_TIMEOUT"),t(w.Failure);break;case Et:r.value||(d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: FAILED_TO_OPEN_WINDOW"),t(w.Failure),d.counter({name:"wallet_failed_to_open_window",value:1}),r.value=!0);break;default:d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler error: UNEXPECTED_STATUS",{errorName:_.name,errorMessage:_.message}),d.error(new At(`loadPaymentData failed with unexpected status code: [${_.name}] ${_.message}`,{groupingHash:`GooglePayUnexpectedStatusCodeError::UnexpectedStatus::${_.name}`}))}null===(p=s.value)||void 0===p||p.call(s,void 0)}d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler cleanup complete"),"GOOGLE_PAY"===(null===(g=u.activeSession)||void 0===g?void 0:g.wallet)?u.clearActiveSession({invokingWallet:"GOOGLE_PAY"}):d.leaveErrorBreadcrumb("[GooglePay] useGooglePayResponseHandler cleanup complete, but activeSession is not Google Pay",{activeSession:u.activeSession}),l.value=void 0,a.value={initialCurrencyCode:void 0}}),[l,a,s,d,t,i,o,n,r,e,u])}(o),wt=function(){const{shippingAddress:e}=ae(),[,r]=re(),n=gt(),{i18n:o,source:i,telemetryClient:s}=y(),l=Tt(),{persistedGooglePaySignal:d}=C(),h=ye(),A=P(),I=ue(ve),{value:S}=he(),D=M((e=>e.reduce(((t,r,a)=>a===e.length-1?o.translate("shipping.shipping_method_combinations.combination",{rest:t,current:r}):o.translate("shipping.shipping_method_combinations.with_separator",{rest:t,current:r})),"")),[o]),R=v((()=>({businessDays:e=>o.translate("shipping.estimated_delivery_date",{count:e}),businessDaysRange:(e,t)=>o.translate("shipping.estimated_delivery_date_range",{minimum:e,maximum:t}),subscriptionsOnlyShippingTitle:o.translate("shipping.subscription_shipping"),combineTwoShippingTitles:(e,t)=>o.translate("shipping.shipping_method_combinations.combination",{rest:e,current:t}),combineMultipleShippingTitles:D})),[o,D]),N=M((({intent:e,trigger:t,result:r})=>{var a,n,i,l,u;if(r.errors.some((e=>Y.has(e.code))))return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, stock problems"),{reason:"OTHER_ERROR",intent:e,message:o.translate("wallets.errors.detour.stock_problems",{walletName:o.translate("brand.google_pay")})};if(r.errors.some((e=>e.code===U)))return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, price mismatch"),{reason:"OTHER_ERROR",intent:e,message:o.translate("wallets.errors.detour.price_change",{walletName:o.translate("brand.google_pay")})};if(r.errors.some((e=>Pe.has(e.code))))return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, delivery zone not found",{zoneCode:null===(n=r.negotiated.shippingAddress)||void 0===n?void 0:n.zoneCode,countryCode:null===(i=r.negotiated.shippingAddress)||void 0===i?void 0:i.countryCode}),{reason:"SHIPPING_ADDRESS_INVALID",intent:e,message:o.translate("wallets.errors.invalid.zone")};if(r.errors.some((e=>z.includes(e.code))))return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, no delivery strategy",{zoneCode:null===(l=r.negotiated.shippingAddress)||void 0===l?void 0:l.zoneCode,countryCode:null===(u=r.negotiated.shippingAddress)||void 0===u?void 0:u.countryCode}),{reason:"SHIPPING_ADDRESS_UNSERVICEABLE",intent:e,message:o.translate("wallets.errors.unsupported.address")};if(!Ae(r.negotiated.paymentMethods,"GOOGLE_PAY"))return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, google pay unavailable"),{reason:"SHIPPING_ADDRESS_UNSERVICEABLE",intent:e,message:o.translate("wallets.errors.unsupported.wallet_is_unavailable",{walletName:o.translate("brand.google_pay")})};const c=d.value;var g;if((null==c?void 0:c.initialCurrencyCode)!==(null===(a=r.negotiated.subtotal)||void 0===a?void 0:a.currencyCode))return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, currency change",{beforeCurrencyCode:null==c?void 0:c.initialCurrencyCode,afterCurrencyCode:null===(g=r.negotiated.subtotal)||void 0===g?void 0:g.currencyCode}),{reason:"OTHER_ERROR",intent:e,message:o.translate("wallets.errors.detour.currency_change",{walletName:o.translate("brand.google_pay")})};const m="INITIALIZE"===t;return r.errors.some((e=>x.includes(e.code)))&&!m?(s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiation error, delivery line changed"),{reason:"SHIPPING_OPTION_INVALID",intent:e,message:o.translate("wallets.errors.outdated.shipping_method")}):void 0}),[d,o,s]),b=M((({result:e,intent:t,trigger:r,resolve:d,reject:c,shippingOptionId:y,abortSignal:v})=>{function h(){return c({reason:"OTHER_ERROR",message:o.translate("wallets.errors.generic",{walletName:o.translate("brand.google_pay")}),intent:t})}if(v.aborted)return s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged result arrived after the session was aborted"),h();switch(s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged received negotiation result",{status:e.status,intent:t,trigger:r}),e.status){case"success":{if(null==e.negotiated.paymentDue)return s.error(new vt("Missing negotiated paymentDue",{groupingHash:"GooglePayGenericError::MissingNegotiatedPaymentDue"})),h();const l=Se(e.negotiated.deliveryNext),c=function({paymentDue:e,subtotal:t,duties:r,taxes:n,deliveryNext:o,discountLines:i,tipLines:s,paymentLines:l,checkoutTotal:d,deferredTotal:c,labels:y,i18nCurrency:v,translations:h,selectedShippingId:P,deliveryMacros:A,paymentFlexibilityPaymentTermsTemplate:I,googlePayTransactionId:S}){var D,R,N,b;const T=null!=A&&A.length?function(e){return e.map((({totalTitle:e,totalCostAfterDiscounts:t,deliveryPromisePresentmentTitle:r,deliveryMethodHandles:a})=>({id:st(a),label:e,description:ct({costAfterDiscounts:t,deliveryPromisePresentmentTitle:r})})))}(A):function(e,t){const r=g(e).filter(m).map(_);return p(r).filter((e=>e.length)).map((e=>{return{id:(r=e,lt(E(r))),label:it(e,t),description:e.map(ct).join(", ")};var r}))}(o,h),O=dt({paymentDue:e,subtotal:t,duties:r,taxes:n,deliveryNext:o,discountLines:i,tipLines:s,paymentLines:l,labels:y,i18nCurrency:v,checkoutTotal:d,deferredTotal:c,hasPayableDeposit:Boolean(null===(D=u({deferredTotal:c,checkoutTotal:d,paymentFlexibilityPaymentTermsTemplate:I}))||void 0===D?void 0:D.amount),googlePayTransactionId:S}),f=null!==(R=null===(N=T.find((e=>e.id===P)))||void 0===N?void 0:N.id)&&void 0!==R?R:null===(b=T[0])||void 0===b?void 0:b.id;return a(a({},T.length>0?{newShippingOptionParameters:{shippingOptions:T,defaultSelectedOptionId:f}}:{}),{},{newTransactionInfo:O})}(a(a({},e.negotiated),{},{labels:n,i18nCurrency:o.currency,translations:R,selectedShippingId:y,deliveryMacros:l,googlePayTransactionId:i.sourceId}));return c.error=N({intent:t,trigger:r,result:e}),s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged handleNegotiationResult",{result:e.status,intent:t,trigger:r}),d(c)}case"throttled":return l(),c({reason:"OTHER_ERROR",message:o.translate("wallets.errors.detour.queue",{walletName:o.translate("brand.google_pay")}),intent:t});case"tooManyRequests":case"denied":case"alreadyCompleted":return l(),h();case"invalid":return e.reasons.includes(Ie.SubmittedForCompletion)?(s.log("payment_data_changed_negotiation_rejected","wallet_rejected_negotiation",{wallet:"google_pay",reason:"invalid",intent:t,trigger:r,reasons:e.reasons}),s.counter({name:"wallet_rejected_negotiation",value:1,attributes:{wallet:"google_pay",reason:"invalid"}})):s.error(new St("Received unhandled invalid result",{groupingHash:"GooglePayInvalidError::UnhandledInvalidResult"}),{metadata:{request:{reasons:e.reasons}}}),h();case"stale":return s.log("payment_data_changed_negotiation_rejected","wallet_rejected_negotiation",{wallet:"google_pay",reason:"stale",intent:t,trigger:r}),s.counter({name:"wallet_rejected_negotiation",value:1,attributes:{wallet:"google_pay",reason:"stale"}}),h();default:return s.error(new vt(`Unhandled negotiation status: ${e.status}${"error"in e&&e.error?`, ${e.error}`:""}`,{groupingHash:"GooglePayGenericError::UnhandledNegotiationStatus"})),h()}}),[l,o,n,R,N,s,i]),T=M(((t,n,o)=>n?new Promise(((i,l)=>{I&&De(S)||r(void 0);const d="INITIALIZE"===o?t.initiallySelectedShippingOptionId:void 0,u=(g=n,m=A.isRequired("firstName"),c(ut({googleAddress:g,isFirstNameRequired:m})));var g,m;s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiating for handleShippingAddressSelected",{trigger:o}),e.value=u,h({abortSignal:t.abortController.signal,fieldsToResolve:["deliveryNext","taxes"],customizeNegotiation:e=>{var t;return a(a({},Ne(e,u,"GOOGLE_PAY")),{},{payment:a(a({},e.payment),{},{totalAmount:{any:!0},paymentLines:Re(null===(t=e.payment)||void 0===t?void 0:t.paymentLines,ft)})})},telemetryClient:s,walletName:G.GooglePay,onComplete:e=>b(a(a({result:e,intent:"SHIPPING_ADDRESS",trigger:o,resolve:i,reject:l},d&&{shippingOptionId:d}),{},{abortSignal:t.abortController.signal})),logPrefix:"GooglePay::usePaymentDataChanged::handleShippingAddressSelected"}).catch((e=>{b({result:e instanceof be?{status:"stale"}:{status:"unexpected_error",error:e},intent:"SHIPPING_ADDRESS",trigger:o,resolve:i,reject:l,abortSignal:t.abortController.signal})}))})):Promise.resolve({})),[A,b,e,r,h,s,I,S]),O=M(((t,n,o)=>new Promise(((i,l)=>{const d=Te(function(e){const t=new RegExp(`[${at}]`,"g");return e.replace(t,'"')}(n));r(d);const u=e.peek();s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged negotiating for handleShippingMethodSelected",{trigger:o}),h({abortSignal:t,fieldsToResolve:["deliveryNext","taxes"],customizeNegotiation:e=>{var t;return a(a({},Ne(e,u,"GOOGLE_PAY")),{},{payment:a(a({},e.payment),{},{totalAmount:{any:!0},paymentLines:Re(null===(t=e.payment)||void 0===t?void 0:t.paymentLines,ft)})})},telemetryClient:s,walletName:G.GooglePay,onComplete:e=>b({result:e,intent:"SHIPPING_OPTION",trigger:o,resolve:i,reject:l,shippingOptionId:n,abortSignal:t}),logPrefix:"GooglePay::usePaymentDataChanged::handleShippingMethodSelected"}).catch((e=>{b({result:e instanceof be?{status:"stale"}:{status:"unexpected_error",error:e},intent:"SHIPPING_OPTION",trigger:o,resolve:i,reject:l,shippingOptionId:n,abortSignal:t})}))}))),[b,e,r,h,s]);return M(function(){var e=t((function*({sessionData:e,intermediatePaymentData:t}){function r(e,t,r){return{error:{reason:e,message:t,intent:r}}}const{shippingAddress:a,shippingOptionData:n,callbackTrigger:i}=t;switch(i){case"INITIALIZE":case"SHIPPING_ADDRESS":return T(e,a,i);case"SHIPPING_OPTION":return null!=n&&n.id?O(e.abortController.signal,n.id,i):r("SHIPPING_OPTION_INVALID",o.translate("general.choose_delivery_strategy"),"SHIPPING_OPTION");default:return s.error(new vt(`Could not recognize the intent: ${i}`,{groupingHash:"GooglePayGenericError::CannotRecognizeIntent"})),s.leaveErrorBreadcrumb("[GooglePay] usePaymentDataChanged could not recognize the intent",{callbackTrigger:i}),r("OTHER_ERROR",o.translate("wallets.errors.generic",{walletName:o.translate("brand.google_pay")}),"SHIPPING_ADDRESS")}}));return function(t){return e.apply(this,arguments)}}(),[T,O,s,o])}(),Lt=function(){const{email:e,shippingAddress:r,billingAddress:n,paymentLines:o}=ae(),{progress:i}=oe(),s=P(),l=ie(),d=A(),u=te(),c=se("googlePay"),g=h("GOOGLE_PAY"),m=function(){const e=te(),{i18n:t,telemetryClient:r}=y(),{inMemoryGooglePayParts:a}=C(),n=v((()=>({genericError:t.translate("wallets.errors.generic",{walletName:t.translate("brand.google_pay")}),shippingMethodError:t.translate("wallets.errors.outdated.shipping_method"),addressUnserviceableError:t.translate("wallets.errors.unsupported.address"),addressInvalid:t.translate("wallets.errors.invalid.shipping_address"),phoneInvalidError:t.translate("wallets.errors.invalid.phone"),zipInvalidError:t.translate("wallets.errors.invalid.postal_code"),zoneInvalidError:t.translate("wallets.errors.invalid.zone"),firstNameMissingError:t.translate("wallets.errors.missing.first_name"),lastNameMissingError:t.translate("wallets.errors.missing.last_name"),addressLine1MissingError:t.translate("wallets.errors.missing.address1"),addressLine2MissingError:t.translate("wallets.errors.missing.address2"),zipMissingError:t.translate("wallets.errors.missing.zip"),zoneMissingError:t.translate("wallets.errors.missing.province"),cityMissingError:t.translate("wallets.errors.missing.city"),emailInvalidError:t.translate("wallets.errors.invalid.email"),phoneMissingError:t.translate("wallets.errors.missing.phone"),billingAddressInvalid:t.translate("wallets.errors.invalid.billing_address"),billingAddressPhoneInvalidError:t.translate("wallets.errors.invalid.billing_phone"),billingAddressZipInvalidError:t.translate("wallets.errors.invalid.billing_zip"),billingAddressZoneInvalidError:t.translate("wallets.errors.invalid.billing_zone"),billingZipInvalidError:t.translate("wallets.errors.invalid.billing_zip"),billingAddressLine1MissingError:t.translate("wallets.errors.missing.billing_address1"),billingAddressFirstNameMissingError:t.translate("wallets.errors.missing.billing_first_name"),billingAddressCityMissingError:t.translate("wallets.errors.missing.billing_city"),billingAddressZipMissingError:t.translate("wallets.errors.missing.billing_zip"),billingAddressZoneMissingError:t.translate("wallets.errors.missing.billing_province")})),[t]);return v((()=>e?new bt(r,n,a):new Nt(r,n,a)),[r,e,n,a])}(),_=Tt(),p=le(),E=de(),{inMemoryGooglePayParts:{paymentSheetOpenPromise:I},persistedGooglePaySignal:S,walletUsedForSubmissionSignal:D}=C(),{telemetryClient:R}=y(),[,N]=re(),b=ue(ce);return M((({isShippingRequired:y,paymentData:v})=>new Promise((h=>{var P,A;const T=ge();R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, attempting completion"),R.counter({name:"wallet_authorization_attempt",value:1,attributes:{instrument:G.GooglePay}});const O=v.shippingAddress,f=null===(P=v.paymentMethodData.info)||void 0===P?void 0:P.billingAddress,C=v.paymentMethodData,M=s.isRequired("address2"),w=m.validateBilling(v),L=m.validateShipping(v,y,M);if(R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, billing and shipping validation results",{billingValidationResult:w,shippingValidationResult:L}),w.paymentSheetAction)return q(w.paymentSheetAction);if(L.paymentSheetAction)return q(L.paymentSheetAction);w.shouldPersist&&f&&(n.value=ut({googleAddress:f,isFirstNameRequired:s.isRequired("firstName")})),L.shouldPersist&&O&&(p({postalCode:O.postalCode,countryCode:O.countryCode,city:O.locality,zoneCode:O.administrativeArea},"GOOGLE_PAY"),r.value=ut({googleAddress:O,isFirstNameRequired:s.isRequired("firstName")})),v.email&&(e.value=v.email),S.value=a(a({},S.peek()),{},{description:C.description});const H=o.peek(),{signature:Y,signedMessage:k,protocolVersion:B}=JSON.parse(v.paymentMethodData.tokenizationData.token),V=d.current.fields.paymentDue.peek();(V&&V.amount>0||l)&&(o.value=me(H,{method:{type:"wallet",name:"GOOGLE_PAY",walletContent:{signature:Y,signedMessage:k,protocolVersion:B,paymentMethodIdentifier:null==g?void 0:g.paymentMethodIdentifier}}}));let x=0;const z=_e(null===(A=d.current.fields.deliveryNext)||void 0===A?void 0:A.peek()),F=()=>{R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, payment authorized completion attempt",{attemptNumber:x}),i("google-pay-payment-authorized",function(){var e=t((function*(e){R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, payment authorized completion result",{result:{status:e.status,violations:("violations"in e?e.violations:[])||[],errors:("errors"in e?e.errors:[])||[]}}),"success"===e.status&&(D.value="GOOGLE_PAY"),"denied"!==e.status&&"throttled"!==e.status&&"tooManyRequests"!==e.status||_();const t=e,r=b&&"rejected"===t.status&&t.violations.some((e=>e.code===U)),{shouldRetry:a,retryReason:n,updatedDeliveryMethodHandles:o}=function(e,t,r,a){const n={shouldRetry:!1,retryReason:"",updatedDeliveryMethodHandles:void 0};if(t>=Ot)return n;if("stale"===e.status)return{shouldRetry:!0,retryReason:"stale",updatedDeliveryMethodHandles:void 0};if("fetch_failed"===e.status)return{shouldRetry:!0,retryReason:"fetch_failed",updatedDeliveryMethodHandles:void 0};var o;if("rejected"===e.status&&null!==(o=e.violations)&&void 0!==o&&o.length){var i;const t=Ee(e,null===(i=r.current.fields.deliveryNext)||void 0===i?void 0:i.peek(),a);if(t)return{shouldRetry:!0,retryReason:"delivery_option_mismatch",updatedDeliveryMethodHandles:t}}return n}(t,x,d,z);if(o&&N(o),a&&!r)return x++,R.counter({name:"wallet_submit_for_completion_retry",value:1,attributes:{retry_reason:n,retry_count:x,status:t.status,instrument:G.GooglePay}}),R.log("payment_authorized_completion_retried",`GooglePay::usePaymentAuthorized: Retrying ${n} completion`,{attemptNumber:x}),void F();const i=m.completionResultMapper.mapResultToPaymentSheetAction(t);R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, payment sheet action mapper result",{paymentSheetAction:i});const s="show_error"===i.action||"abort"===i.action?"failed":"success";try{yield q(i)}finally{R.histogram({name:"wallet_authorization_complete",value:ge()-T,attributes:{instrument:G.GooglePay,result:s,retry_count:x>0?x.toString():void 0},unit:"ms"}),R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, authorization result",{authorizationResult:s}),!u||"rejected"!==e.status&&"invalid"!==e.status||(null==E||E.dispatch("addressReplaced"),c())}}));return function(t){return e.apply(this,arguments)}}(),{skipToCompletion:!0,customizeCompletion:pe})};function q(e){return j.apply(this,arguments)}function j(){return(j=t((function*(e){var t,r;if(null===(t=e.effects)||void 0===t||t.forEach((e=>e())),"show_error"===e.action)return R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, resolving with error",{paymentSheetAction:e}),void h({transactionState:"ERROR",error:null===(r=e.errors)||void 0===r?void 0:r[0]});R.leaveErrorBreadcrumb("[GooglePay] usePaymentAuthorized, resolving with success"),h({transactionState:"SUCCESS"}),yield I.value}))).apply(this,arguments)}F()}))),[s,_,null==g?void 0:g.paymentMethodIdentifier,l,u,d,I,m,S,i,n,e,o,r,D,E,c,p,R,N,b])}(),Ht=Fe(),Yt=qe(),Ut=je({onPaymentAuthorized:Lt,onPaymentDataChanged:e=>wt({sessionData:H.current,intermediatePaymentData:e}),onClick:(kt=t((function*(){return De(L)&&(H.current.initiallySelectedShippingOptionId=st(O)),yield Rt()})),function(){return kt.apply(this,arguments)}),onResponse:e=>{const t=H.current.abortController;H.current={abortController:Mt(),initiallySelectedShippingOptionId:void 0};const r=Gt(e);return t.abort(),r},telemetry:Ht,breadcrumb:Yt});var kt;Ze((()=>{const e=q&&j.current;n.value&&Z.value&&(!F.current||e)&&(W.leaveErrorBreadcrumb("[GooglePay] GooglePayButton updatePaymentDataRequest"),q&&(j.current=!1),n.value.call.updatePaymentDataRequest(Z.value))})),T((()=>(Ct({status:"loading"},k,r),()=>{const e=k.peek(),t=B.peek();var a;e===r.current&&"error"!==t.status&&(W.leaveErrorBreadcrumb("GooglePayButton cleanup"),k.value={status:"idle"},B.value={status:"not_rendered"},"GOOGLE_PAY"===(null===(a=X.activeSession)||void 0===a?void 0:a.wallet)&&(W.leaveErrorBreadcrumb("GooglePayButton cleanup: resetting activeSession"),X.clearActiveSession({invokingWallet:"GOOGLE_PAY"})))})),[]);const Bt=e?pt:void 0,Vt=Qe(Xe,{inlineAlignment:"center",children:Qe(et,{size:"large"})}),xt=nt&&ne,zt=!ne&&!ot,Ft=Qe(We,{isOpen:o.value,isInvisible:xt,onClick:i,children:zt&&Qe($e,{handleClose:i,walletName:$.translate("brand.google_pay")})}),qt=Qe(Ke,{children:[Qe(tt,{wallet:_t,onConnect:It,onTerminate:()=>n.value=null,hostMethods:Ut,ref:Q,height:Bt}),Ft]}),jt=e&&"rendered"!==B.value.status&&"error"!==B.value.status;return e?Qe(Ke,{children:[jt&&Vt,Qe(Xe,{className:Je({[Dt.GooglePayButtonContainerSpinnerDisplayed]:jt}),children:qt})]}):qt}));const rt={apiVersion:2,apiVersionMinor:0},at="%",nt={"أبو ظبي":"AZ","إمارة الشارقةّ":"SH","الفجيرة":"FU","عجمان":"AJ","رأس الخيمة":"RK","إمارة رأس الخيمة":"RK","أم القيوين":"UQ","ام القيوين":"UQ","دبي":"DU","إمارة دبيّ":"DU"},ot=e=>"Méx."===e?"MEX":"Q.R."===e?"Q ROO":e.replace(/\./g,"").toUpperCase();function it(e,t){var r;const a=e.find((e=>"ONE_TIME_PURCHASE"===e.deliveryLine.type)),n=e.find((e=>"SUBSCRIPTION"===e.deliveryLine.type));let o="";if(n){if("PICK_UP"===n.methodType||"LOCAL"===n.methodType)return n.title;o=n.title}const i=[null!==(r=null==a?void 0:a.title)&&void 0!==r?r:"",o].filter(Boolean);switch(i.length){case 0:case 1:return i.join("");case 2:return t.combineTwoShippingTitles(i[0],i[1]);default:return t.combineMultipleShippingTitles(i)}}function st(e){return lt(JSON.stringify(e))}function lt(e){return e.replace(/["']/g,at)}function dt({paymentDue:e,subtotal:t,duties:r,taxes:a,deliveryNext:n,discountLines:d,tipLines:u,paymentLines:c,labels:g,i18nCurrency:m,checkoutTotal:_,deferredTotal:p,hasPayableDeposit:E,googlePayTransactionId:y}){const v=e?o(e.amount):"0",h=E&&_&&p,P=h?o(_.amount):void 0,A=h?o(p.amount.amount):void 0,I=[];t&&I.push({label:g.subtotal,type:"SUBTOTAL",price:o(t.amount)});const S=i(n).reduce(((e,t)=>e+t.method.cost.amount),0);return I.push({label:g.shipping,type:"LINE_ITEM",price:o(S)}),r&&"available_total"===(null==r?void 0:r.status)&&0!==(null==r?void 0:r.totalDuty.amount)&&I.push({label:g.duties,type:"LINE_ITEM",price:o(r.totalDuty.amount)}),a&&"available_total"===a.status&&0!==a.totalTax.amount&&I.push({label:g.taxes,type:"LINE_ITEM",price:o(a.totalTax.amount)}),null==d||d.lines.forEach((e=>{if(s(e)){var t;const r=null===(t=e.amount)||void 0===t?void 0:t.amount;r&&I.push({label:e.title,type:"LINE_ITEM",price:l(o(r))})}})),null==c||c.lines.filter((e=>"giftCard"===e.method.type)).forEach((e=>{e.cost&&I.push({label:`${g.giftCard} ${e.method.code.slice(-4).toUpperCase()}`,type:"LINE_ITEM",price:l(o(e.cost.amount))})})),null==u||u.forEach((e=>{I.push({label:g.tip,type:"LINE_ITEM",price:o(e.amount.amount)})})),P&&I.push({label:g.deposit,type:"LINE_ITEM",price:P}),A&&I.push({label:g.totalDueLater,type:"LINE_ITEM",price:A}),{totalPrice:P||v,currencyCode:(null==t?void 0:t.currencyCode)||m,totalPriceStatus:"ESTIMATED",totalPriceLabel:P?g.totalDueToday:g.total,displayItems:I,transactionId:`co-${y}`}}function ut({googleAddress:e,isFirstNameRequired:t}){let r=e.administrativeArea||void 0,a=e.locality||void 0,n=e.countryCode;"AE"===e.countryCode&&(a=e.administrativeArea,r&&(r=nt[r]||r)),"MX"===e.countryCode&&r&&(r=ot(r)),e.countryCode&&d.includes(e.countryCode)&&(r=e.countryCode,n="US");const o={city:a,postalCode:e.postalCode||void 0,zoneCode:r,countryCode:n};if("name"in e){const[r,...a]=(e.name||"").split(" ");0===a.length?(o.lastName=r,t&&(o.firstName=o.lastName)):(o.firstName=r,o.lastName=a.join(" "))}return"address1"in e&&(o.address1=e.address1),"address2"in e&&(o.address2=e.address2),"phoneNumber"in e&&(o.phone=e.phoneNumber),o}function ct({costAfterDiscounts:e,deliveryPromisePresentmentTitle:t}){const{short:r}=t||{};return`${r?`(${r}) `:""}${o(e.amount)} ${e.currencyCode}`}function gt(){const{i18n:e}=y();return v((()=>({total:e.translate("order_summary.total_label"),subtotal:e.translate("order_summary.subtotal_label"),shipping:e.translate("order_summary.shipping_label"),duties:e.translate("order_summary.duties_label"),taxes:e.translate("order_summary.estimated_taxes_label"),giftCard:e.translate("order_summary.gift_card_label"),tip:e.translate("order_summary.tip_label"),deposit:e.translate("order_summary.deposit_label"),totalDueToday:e.translate("order_summary.total_due_today_label"),totalDueLater:e.translate("order_summary.total_due_later_label")})),[e])}function mt(){const{shop:{name:e,myshopifyDomain:t}}=y(),r=h("GOOGLE_PAY"),a=void 0===r;return v((()=>a?void 0:{merchantName:e,merchantId:r.merchantId,merchantOrigin:t,authJwt:r.authJwt}),[a,e,null==r?void 0:r.merchantId,null==r?void 0:r.authJwt,t])}const _t="GOOGLE_PAY",pt="54px",Et="FAILED_TO_OPEN_WINDOW",yt="VALIDATION_TIMEOUT";class vt extends O{constructor(...e){super(...e),n(this,"name","GooglePayGenericError")}}class ht extends O{constructor(...e){super(...e),n(this,"name","GooglePayCreateButtonError")}}class Pt extends O{constructor(...e){super(...e),n(this,"name","GooglePayDeveloperError")}}class At extends O{constructor(...e){super(...e),n(this,"name","GooglePayUnexpectedStatusCodeError")}}class It extends O{constructor(...e){super(...e),n(this,"name","GooglePaySubmissionError")}}class St extends O{constructor(...e){super(...e),n(this,"name","GooglePayInvalidError")}}const Dt={GooglePayButtonContainerSpinnerDisplayed:"QIbE6"};class Rt extends L{constructor(e,t){super(),this.telemetryClient=e,this.translated=t}get negotiationResultMapper(){return null}get completionResultMapper(){return new H({success:({result:e})=>"receipt"in e?{action:"submit"}:{action:"abort"},rejected:({result:e,violationActions:t})=>{var r;const a=null!==(r=e.violations)&&void 0!==r?r:[];this.getUnhandledErrors(a,t).forEach((e=>{this.telemetryClient.error(new It(`submitForCompletion in ${this.isRedesign()?"redesign":"3-page"} Google Pay failed due to unhandled error ${e.code}`,{groupingHash:"GooglePaySubmissionError::SubmitForCompletion::UnhandledError"}),{severity:"error"})}));const{firstPaymentSheetAction:n,violationCode:o}=this.getMergedPaymentSheetAction({resultViolations:a,violationActions:t});return o&&this.telemetryClient.counter({name:"wallet_action_generator_handled_error",value:1,attributes:{violationCode:o,WalletName:G.GooglePay}}),n||{action:"abort"}},invalid:({result:e})=>{const t={reasons:JSON.stringify(e.reasons),action:"invalid"};return this.telemetryClient.counter({name:"WalletsPlatform_google_pay_payment_sheet_unexpected_action",value:1,attributes:t}),{action:"abort"}},denied:()=>({action:"abort"}),throttled:()=>({action:"abort"}),tooManyRequests:()=>({action:"abort"}),alreadyCompleted:()=>({action:"abort"}),fetch_failed:()=>(this.telemetryClient.counter({name:"WalletsPlatform_google_pay_payment_sheet_unexpected_action",attributes:{action:"fetch_failed"},value:1}),{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_AUTHORIZATION",message:this.translated.genericError}]})},(e=>this.mapUnhandledStatus(e)),((e,t)=>this.getCompletionViolationActions(e,t)))}mapUnhandledStatus(e){return this.telemetryClient.error(new It(`Unhandled completion status: ${e.status}`,{groupingHash:"GooglePaySubmissionError::UnhandledCompletionStatus"})),{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_AUTHORIZATION",message:this.translated.genericError}]}}}class Nt extends Rt{constructor(e,t,r){super(e,t),this.inMemoryGooglePayParts=r}validateBilling(e){var t;return(null===(t=e.paymentMethodData.info)||void 0===t?void 0:t.billingAddress)?{shouldPersist:!0}:{shouldPersist:!1,paymentSheetAction:{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_METHOD",message:this.translated.genericError}]}}}validateShipping(e,t,r){const a=e.shippingAddress;return t?a?r&&!a.address2?{shouldPersist:!1,paymentSheetAction:{action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.addressLine2MissingError}]}}:{shouldPersist:!0}:{shouldPersist:!1,paymentSheetAction:{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_METHOD",message:this.translated.genericError}]}}:{shouldPersist:!1}}isRedesign(){return!1}getCompletionViolationActions(e,t){return[{violations:[...Y,"MERCHANDISE_NOT_APPLICABLE"],generateAction:()=>({action:"abort"})},{violations:[U],generateAction:()=>({action:"abort"})},{violations:k,generateAction:()=>({action:"abort"})},{violations:B,generateAction:()=>({action:"abort"})},{violations:V,generateAction:()=>({action:"abort",effects:[()=>{this.inMemoryGooglePayParts.paymentSheetError.value={type:"unexpected_terminal_error"}}]})},{violations:x,generateAction:()=>({action:"abort",effects:[()=>{this.inMemoryGooglePayParts.paymentSheetError.value={type:"unusable_partial_address"}}]})},{violations:z,generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_UNSERVICEABLE",intent:"SHIPPING_ADDRESS",message:this.translated.addressUnserviceableError}]})},{violations:["DELIVERY_WRONG_NUMBER_OF_DELIVERY_LINES"],generateAction:()=>({action:"abort"})},{violations:["DELIVERY_STRATEGY_CONDITIONS_NOT_SATISFIED"],generateAction:()=>({action:"abort"})},{violations:["DELIVERY_FIRST_NAME_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.firstNameMissingError}]})},{violations:["DELIVERY_LAST_NAME_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.lastNameMissingError}]})},{violations:["DELIVERY_ADDRESS1_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.addressLine1MissingError}]})},{violations:["DELIVERY_ADDRESS2_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.addressLine2MissingError}]})},{violations:["DELIVERY_PHONE_NUMBER_REQUIRED","DELIVERY_OPTIONS_PHONE_NUMBER_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.phoneMissingError}]})},{violations:["DELIVERY_COMPANY_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.addressInvalid}]})},{violations:["DELIVERY_POSTAL_CODE_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.zipMissingError}]})},{violations:["DELIVERY_CITY_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.cityMissingError}]})},{violations:["DELIVERY_ZONE_REQUIRED_FOR_COUNTRY"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.zoneMissingError}],effects:[()=>{const{shippingZone:e,shippingCountry:r}=Q(t);this.telemetryClient.log("three_page_payment_sheet_action_generator_payment_completion_failed","google_pay_payment_completion_failed",{reason:"DELIVERY_ZONE_REQUIRED_FOR_COUNTRY",shippingZone:e,shippingCountry:r,result:t})}]})},{violations:["DELIVERY_ZONE_NOT_FOUND"],generateAction:()=>{const{shippingZone:e,shippingCountry:r}=Q(t);return{action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_OPTION",message:this.translated.zoneInvalidError}],effects:[()=>{this.telemetryClient.log("three_page_payment_sheet_action_generator_payment_completion_failed","google_pay_payment_completion_failed",{reason:"DELIVERY_ZONE_NOT_FOUND",shippingZone:e,shippingCountry:r,result:t})}]}}},{violations:F,generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.emailInvalidError}]})},{violations:["DELIVERY_ADDRESS1_CONTAINS_EMOJIS","DELIVERY_ADDRESS1_CONTAINS_HTML_TAGS","DELIVERY_ADDRESS1_CONTAINS_MATHEMATICAL_SYMBOLS","DELIVERY_LAST_NAME_CONTAINS_URL"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.addressInvalid}]})},{violations:["DELIVERY_OPTIONS_PHONE_NUMBER_DOES_NOT_MATCH_EXPECTED_PATTERN","DELIVERY_PHONE_NUMBER_DOES_NOT_MATCH_EXPECTED_PATTERN"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.phoneInvalidError}]})},{violations:["DELIVERY_INVALID_POSTAL_CODE_FOR_ZONE","DELIVERY_INVALID_POSTAL_CODE_FOR_COUNTRY"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.zipInvalidError}]})},{violations:["PAYMENTS_METHOD_REQUIRED","PAYMENTS_METHOD"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.genericError}]})},{violations:["PAYMENTS_FIRST_NAME_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressFirstNameMissingError}]})},{violations:["PAYMENTS_LAST_NAME_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.lastNameMissingError}]})},{violations:["PAYMENTS_ADDRESS1_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressLine1MissingError}]})},{violations:["PAYMENTS_CITY_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressCityMissingError}]})},{violations:["PAYMENTS_ZONE_REQUIRED_FOR_COUNTRY"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressZoneMissingError}]})},{violations:["PAYMENTS_POSTAL_CODE_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressZipMissingError}]})},{violations:["PAYMENTS_PHONE_NUMBER_DOES_NOT_MATCH_EXPECTED_PATTERN"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressPhoneInvalidError}]})},{violations:[q],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressZipInvalidError}]})},{violations:[j],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressZoneInvalidError}]})},{violations:["PAYMENTS_INVALID_POSTAL_CODE_FOR_ZONE"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingZipInvalidError}]})},{violations:["PAYMENTS_ADDRESS1_CONTAINS_HTML_TAGS","PAYMENTS_CITY_CONTAINS_HTML_TAGS","PAYMENTS_LAST_NAME_CONTAINS_URL"],generateAction:()=>({action:"show_error",errors:[{reason:"PAYMENT_DATA_INVALID",intent:"PAYMENT_METHOD",message:this.translated.billingAddressInvalid}]})},{violations:["BUYER_IDENTITY_PHONE_NUMBER_DOES_NOT_MATCH_EXPECTED_PATTERN"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.phoneInvalidError}]})},{violations:["BUYER_IDENTITY_MISSING_CONTACT_METHOD","BUYER_IDENTITY_CONTACT_INFO_DOES_NOT_MATCH_CUSTOMER_PROFILE"],generateAction:()=>({action:"abort",effects:[()=>{this.inMemoryGooglePayParts.paymentSheetError.value={type:"unexpected_terminal_error"}}]})},{violations:["BUYER_IDENTITY_EMAIL_REQUIRED"],generateAction:()=>({action:"show_error",errors:[{reason:"SHIPPING_ADDRESS_INVALID",intent:"SHIPPING_ADDRESS",message:this.translated.emailInvalidError}]})},{violations:Z,generateAction:()=>({action:"abort"})},{violations:Array.from($),generateAction:()=>({action:"abort"})}]}}class bt extends Rt{constructor(e,t,r){super(e,t),this.inMemoryGooglePayParts=r}validateBilling(e){var t;return(null===(t=e.paymentMethodData.info)||void 0===t?void 0:t.billingAddress)?{shouldPersist:!0}:{shouldPersist:!1,paymentSheetAction:{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_METHOD",message:this.translated.genericError}]}}}validateShipping(e,t){const r=e.shippingAddress;return t?r?{shouldPersist:!0}:{shouldPersist:!1,paymentSheetAction:{action:"show_error",errors:[{reason:"OTHER_ERROR",intent:"PAYMENT_METHOD",message:this.translated.genericError}]}}:{shouldPersist:!1}}isRedesign(){return!0}getCompletionViolationActions(e,t){return[{violations:[...Y,"MERCHANDISE_NOT_APPLICABLE"],generateAction:()=>({action:"abort"})},{violations:[U],generateAction:()=>({action:"abort"})},{violations:k,generateAction:()=>({action:"abort"})},{violations:B,generateAction:()=>({action:"abort"})},{violations:V,generateAction:()=>({action:"abort",effects:[()=>{this.inMemoryGooglePayParts.paymentSheetError.value={type:"unexpected_terminal_error"}}]})},{violations:x,generateAction:()=>({action:"abort"})},{violations:z,generateAction:()=>({action:"abort"})},{violations:["DELIVERY_ZONE_NOT_FOUND"],generateAction:()=>{const{shippingZone:e,shippingCountry:r}=Q(t);return{action:"abort",effects:[()=>{this.telemetryClient.log("redesign_payment_sheet_action_generator_payment_completion_failed","google_pay_payment_completion_failed",{reason:"DELIVERY_ZONE_NOT_FOUND",shippingZone:e,shippingCountry:r,result:t})}]}}},{violations:["DELIVERY_WRONG_NUMBER_OF_DELIVERY_LINES"],generateAction:()=>({action:"abort"})},{violations:W,generateAction:()=>({action:"abort"})},{violations:X,generateAction:()=>({action:"abort"})},{violations:J,generateAction:()=>({action:"abort"})},{violations:["DELIVERY_ZONE_REQUIRED_FOR_COUNTRY"],generateAction:()=>({action:"abort",effects:[()=>{const{shippingZone:e,shippingCountry:r}=Q(t);this.telemetryClient.log("redesign_payment_sheet_action_generator_payment_completion_failed","google_pay_payment_completion_failed",{reason:"DELIVERY_ZONE_REQUIRED_FOR_COUNTRY",shippingZone:e,shippingCountry:r,result:t})}]})},{violations:["PAYMENTS_METHOD_REQUIRED","PAYMENTS_METHOD"],generateAction:()=>({action:"abort"})},{violations:K,generateAction:()=>({action:"abort"})},{violations:ee,generateAction:()=>({action:"abort"})},{violations:["PAYMENTS_PHONE_NUMBER_DOES_NOT_MATCH_EXPECTED_PATTERN"],generateAction:()=>({action:"abort"})},{violations:["BUYER_IDENTITY_MISSING_CONTACT_METHOD"],generateAction:()=>({action:"abort"})},{violations:["BUYER_IDENTITY_CONTACT_INFO_DOES_NOT_MATCH_CUSTOMER_PROFILE"],generateAction:()=>({action:"abort",effects:[()=>{this.inMemoryGooglePayParts.paymentSheetError.value={type:"unexpected_terminal_error"}}]})},{violations:["BUYER_IDENTITY_PHONE_NUMBER_DOES_NOT_MATCH_EXPECTED_PATTERN"],generateAction:()=>({action:"abort"})},{violations:["BUYER_IDENTITY_EMAIL_REQUIRED"],generateAction:()=>({action:"abort"})},{violations:F,generateAction:()=>({action:"abort"})},{violations:Z,generateAction:()=>({action:"abort"})},{violations:Array.from($),generateAction:()=>({action:"abort"})}]}}function Tt(){const{persistedGooglePaySignal:e}=C(),[,t]=re(),r=P(),{telemetryClient:n}=y(),{email:o,shippingAddress:i,paymentLines:s}=ae();return M((()=>{n.leaveErrorBreadcrumb("[GooglePay] useClearGooglePayProposedState clearing proposed state");const l=ne(s.peek());s.value=l,o.value="",e.value=a(a({},e.peek()),{},{description:void 0}),t(void 0),i.value={city:void 0,address1:void 0,address2:void 0,company:void 0,firstName:void 0,lastName:void 0,name:void 0,phone:void 0,postalCode:void 0,coordinates:void 0,countryCode:r.defaultShippingDetails.country.code,zoneCode:r.defaultShippingDetails.zone.code}}),[r.defaultShippingDetails,e,o,s,i,t,n])}const Ot=1,ft={paymentMethod:{walletPaymentMethod:{name:"GOOGLE_PAY",walletContent:{googlePayWalletContent:{signature:"",signedMessage:"",protocolVersion:""}}}},amount:{any:!0}};function Ct(e,t,r){r.current=e,t.value=r.current}function Mt(){return new AbortController}}}}))}();
