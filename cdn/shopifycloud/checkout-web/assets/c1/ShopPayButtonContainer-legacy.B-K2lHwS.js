!function(){const e=["logging","messenger"];function n(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function t(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?n(Object(o),!0).forEach((function(n){r(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function r(e,n,t){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n,t,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void t(e)}s.done?n(l):Promise.resolve(l).then(r,o)}function a(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var i=e.apply(n,t);function s(e){o(i,r,a,s,l,"next",e)}function l(e){o(i,r,a,s,l,"throw",e)}s(void 0)}))}}System.register(["./app-legacy.CVtZXpP_.js","./useShopPayPaymentRequiredMethod-legacy.DC5RFglA.js","./get-negotiation-input-legacy.B6QB99As.js","./NotFound-legacy.Bsa7sasp.js","./useEditorShopPayNavigation-legacy.DSNvU3i0.js","./useShopPaySessionTokenStorage-legacy.C9z0D7nF.js"],(function(n,o){"use strict";var i,s,l,d,u,c,p,h,m,g,y,f,v,_,b,P,C,S,k,I,E,x,A,w,B,M,T,N,$,L,D,O,U,R,z,F,j,q,H,G,Y,J,V,W,K,X,Z,Q,ee,ne,te,re,oe,ae,ie,se,le,de,ue,ce,pe,he,me,ge,ye,fe,ve,_e,be,Pe,Ce,Se,ke,Ie,Ee,xe,Ae,we,Be,Me,Te,Ne,$e,Le,De,Oe,Ue,Re,ze,Fe,je,qe,He,Ge,Ye,Je,Ve,We,Ke,Xe,Ze,Qe,en,nn,tn,rn,on,an,sn,ln,dn,un,cn,pn,hn,mn,gn,yn,fn,vn,_n,bn,Pn,Cn,Sn,kn,In,En,xn,An,wn,Bn,Mn,Tn,Nn,$n,Ln,Dn,On,Un,Rn,zn,Fn,jn,qn,Hn,Gn,Yn,Jn,Vn,Wn,Kn,Xn,Zn,Qn,et,nt,tt,rt,ot;return{setters:[e=>{i=e.eX,s=e.i,l=e.z,d=e.a,u=e.aT,c=e.R,p=e.aM,h=e.aF,m=e.aN,g=e.mH,y=e.mI,f=e.T,v=e.ao,_=e.W,b=e.a_,P=e.s,C=e.mJ,S=e.cm,k=e.im,I=e.ea,E=e.mK,x=e.eh,A=e.mL,w=e.ef,B=e.mM,M=e.bw,T=e.dX,N=e.cR,$=e.eg,L=e.aH,D=e.k,O=e.t,U=e.mN,R=e.gI,z=e.mO,F=e.q,j=e.x,q=e.mP,H=e.i8,G=e.l_,Y=e.ee,J=e.n,V=e.ej,W=e.i7,K=e.mQ,X=e.ia,Z=e.mR,Q=e.f4,ee=e.B,ne=e.mS,te=e.em,re=e.mT,oe=e.aD,ae=e.mU,ie=e.i4,se=e.mV,le=e.aZ,de=e.bf,ue=e.cc,ce=e.cd,pe=e.a0,he=e.l2,me=e.a1,ge=e.mW,ye=e.mX,fe=e.g8,ve=e.f2,_e=e.i_,be=e.l0,Pe=e.mY,Ce=e.l1,Se=e.mZ,ke=e.m_,Ie=e.m$,Ee=e.n0,xe=e.n1,Ae=e.n2,we=e.iw,Be=e.n3,Me=e.n4,Te=e._,Ne=e.cb,$e=e.fX,Le=e.n5,De=e.D,Oe=e.n6,Ue=e.jz,Re=e.n7,ze=e.n8,Fe=e.n9,je=e.na,qe=e.nb,He=e.nc,Ge=e.nd,Ye=e.ne,Je=e.g7,Ve=e.ca,We=e.nf,Ke=e.e_,Xe=e.ng,Ze=e.nh,Qe=e.hm,en=e.ni,nn=e.jT,tn=e.ix,rn=e.nj,on=e.kG,an=e.kL,sn=e.nk,ln=e.eP,dn=e.gq,un=e.nl,cn=e.gi,pn=e.b7,hn=e.nm,mn=e.aX,gn=e.bh,yn=e.nn,fn=e.b5,vn=e.l3,_n=e.no,bn=e.np,Pn=e.il,Cn=e.nq,Sn=e.je,kn=e.nr,In=e.aP,En=e.ns,xn=e.gd,An=e.nt,wn=e.nu,Bn=e.nv,Mn=e.nw,Tn=e.eY,Nn=e.nx,$n=e.L,Ln=e.ks,Dn=e.g3,On=e.a9,Un=e.ny,Rn=e.nz,zn=e.nA,Fn=e.nB,jn=e.iN,qn=e.nC,Hn=e.jH,Gn=e.nD,Yn=e.kP,Jn=e.nE},e=>{Vn=e.u,Wn=e.a,Kn=e.b},e=>{Xn=e.s},e=>{Zn=e.a,Qn=e.u},e=>{et=e.b,nt=e.S},e=>{tt=e.a,rt=e.u,ot=e.b}],execute:function(){var o=document.createElement("style");o.textContent=".nuxWF{position:relative;overflow:hidden;display:inline-block}[dir=ltr] .AfOP8{left:0}[dir=rtl] .AfOP8{right:0}.AfOP8{fill:var(--x-default-color-brand);position:absolute;top:0;height:100%;width:100%;transform-origin:center}.AfOP8.pqnj6{fill:#fff}.i4kx9{animation:Bsy72 .5s linear infinite}.ttRly{opacity:.3;animation:Bsy72 1s linear infinite reverse}@keyframes Bsy72{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.MEXbs{position:relative;z-index:-1;display:flex;width:100%;justify-content:space-between}.O2SWd{display:flex;align-items:center;justify-content:center;height:50px;width:14.6667%;background-color:var(--x-default-color-background);border:1px solid var(--x-default-color-border);border-radius:var( --x-control-border-radius, var(--x-global-border-radius, var(--x-border-radius-base)) );color:var(--x-default-color-text);transition:border .5s cubic-bezier(.2,.9,.3,1);font-size:25px;font-weight:700;-webkit-font-smoothing:inherit}.tMP9u{border-width:2px;border-color:var(--x-default-color-accent)}.A7Hsz{border-color:var(--x-default-color-success)}.oUUJk{border-color:var(--x-default-color-critical)}.XbKGE{position:relative;z-index:1;overflow:hidden;width:276px;margin:5px auto;text-align:initial}[dir=ltr] ._21xeZ{padding-left:12px}[dir=rtl] ._21xeZ{padding-right:12px}._21xeZ{text-align:initial;position:absolute;top:10px;z-index:10;width:100%;margin:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:none;outline:none;font-size:25px;font-weight:700;-webkit-font-smoothing:inherit;line-height:normal;letter-spacing:1.33em;caret-color:var(--x-default-color-text);outline-offset:0;color:transparent;font-family:Arial,Helvetica Neue,Helvetica,sans-serif}._21xeZ::-moz-selection{background:transparent}._21xeZ::selection{background:transparent}._21xeZ:-webkit-autofill{opacity:0}._21xeZ::-ms-clear{display:none}.iNU0B{display:flex;align-items:center;height:calc(32px + var(--x-spacing-small-100))}.gwGKY{vertical-align:text-bottom}.gwGKY [data-logo-part=text]{fill:var(--x-default-color-text)}._1qn1o{color:#6445ed}.TvbzE{position:fixed;left:0;right:0;z-index:300;margin:0;overflow:visible;background:linear-gradient(to top,#fff,#fff 88%,rgba(255,255,255,0));-webkit-backdrop-filter:blur(.6px);backdrop-filter:blur(.6px)}.VaWCO{height:90px}.HKMr7{margin:0 auto;max-width:102rem;padding:var(--x-spacing-large-200);padding-top:21px;padding-bottom:calc(var(--x-spacing-large-200) + env(safe-area-inset-bottom))}.HKMr7 button{border-radius:var(--x-border-radius-base);box-shadow:0 8px 15px rgba(0,0,0,.24)}\n/*$vite$:1*/",document.head.appendChild(o),n("default",(function(){!function(){const{loading:e}=Ln(),{postPurchaseEnabled:n}=Dn(),{monorail:r,source:o,checkout:d,shop:u,telemetryClient:c}=s(),p=function(){const e=i();return l(function(){var n=a((function*(n){var t;const{data:r,error:o}=yield e.mutate(Zt,{variables:{creditCardId:n}});if(o||null==r||!r.billingAgreementCreate)return{status:"failed"};const{billingAgreementCreate:a}=r;return a.userErrors.length>0?{status:"failed",errors:a.userErrors}:{status:"success",billingAgreementToken:null!==(t=a.billingAgreementToken)&&void 0!==t?t:void 0}}));return function(e){return n.apply(this,arguments)}}(),[e])}(),h=I(),m=On(),g=P.selectedPaymentMethod.value,y=P.installmentsPayment.value,f=P.shopAccountUuid.value,v=P.secureData.value,_=P.selectedFreeCheckoutBillingAddress.value,b=J().billingAddress.value,{cashback:C}=Q(),{checkout_as_guest_url:S}=ee(),k=function(){const e=we(),n=function(){const e=i(),{telemetryClient:n,shop:{myshopifyDomain:r},source:{checkoutSessionIdentifier:o}}=s(),d=function(){const{value:e}=wn(),{perShopCheckoutSessionIdentifier:n}=null!=e?e:{};if(null==n)return[];const t=[];for(const[r,o]of n)t.push({checkoutIdentifier:o,shopId:Bn(r)||""});return t}(),u=Mn();return l(function(){var i=a((function*({addressId:a,creditCardId:i,installmentsAgreements:s,unvaultedShippingAddress:l}){const c=l?Tn(l):void 0;o||n.error(new xn({groupingHash:"ShopPayCheckoutIdentifierMissingError::useShopPayPaymentSessionCallback"}));const{data:p,error:h}=yield e.mutate(nr,{variables:{checkoutSessionIdentifier:o||"checkout_identifier_undefined",shopifyDomain:r,addressId:a,checkoutClientSource:u,creditCardId:i,installmentsAgreements:s,unvaultedShippingAddress:c,batchCheckouts:d}});if(h||null==p||null==p.paymentSessionGenerate)return h&&h instanceof An?{status:"failed",statusCode:h.response.status}:{status:"failed"};const{userErrors:m,sessionId:g,batchCheckoutSessionIds:y}=p.paymentSessionGenerate;return m.length>0||null==g||d.length&&(null==y?void 0:y.length)!==d.length?{status:"failed",errors:m}:t({status:"success",sessionId:g},null!=y&&y.length?{batchCheckoutSessionIds:y.map((({sessionId:e,shopId:n})=>({sessionId:e,shopId:Nn("Shop",n)})))}:{})}));return function(e){return i.apply(this,arguments)}}(),[e,n,o,r,u,d])}(),r=function(){const e=i(),{telemetryClient:n,shop:{myshopifyDomain:t},source:{checkoutSessionIdentifier:r}}=s();return l(function(){var o=a((function*({addressId:o,creditCardId:a,installmentsParams:i,debugContext:s}){n.leaveErrorBreadcrumb("Calling paymentMethodGenerate mutation"),o||n.error(new er,{metadata:{context:s}}),r||n.error(new xn({groupingHash:"ShopPayCheckoutIdentifierMissingError::useShopPayExternalPaymentSessionCallback"}));const{data:l,error:d}=yield e.mutate(Qt,{variables:{checkoutSessionIdentifier:r||"checkout_identifier_undefined",shopifyDomain:t,addressId:o,creditCardId:a,installmentsParams:i}});if(d||null==l||null==l.paymentMethodGenerate)return n.leaveErrorBreadcrumb("Payment method generate mutation failed due to error"),d&&d instanceof An?{status:"failed",statusCode:d.response.status}:{status:"failed"};const{userErrors:u,paymentMethod:c}=l.paymentMethodGenerate;return u.length>0||null==c?(n.leaveErrorBreadcrumb("Payment method generate mutation failed due to user errors"),{status:"failed",errors:u}):(n.leaveErrorBreadcrumb("Payment method generate mutation succeeded"),{status:"success",sessionId:c})}));return function(e){return o.apply(this,arguments)}}(),[r,e,n,t])}(),o=function(){const e=i(),{telemetryClient:n,shop:{myshopifyDomain:t},source:{checkoutSessionIdentifier:r}}=s();return l(function(){var o=a((function*({addressId:o,creditCardId:a,installmentsParams:i}){n.leaveErrorBreadcrumb("Calling paymentSelectionCreate mutation"),o||n.error(new rr),r||n.error(new xn({groupingHash:"ShopPayCheckoutIdentifierMissingError::useShopPayExternalPaymentSelectionCreateCallback"}));const{data:s,error:l}=yield e.mutate(tr,{variables:{checkoutSessionIdentifier:r||"checkout_identifier_undefined",shopifyDomain:t,addressId:o,creditCardId:a,installmentsParams:i}});if(l||null==s||null==s.paymentSelectionCreate)return n.leaveErrorBreadcrumb("Payment selection create mutation failed due to error"),l&&l instanceof An?{status:"failed",statusCode:l.response.status}:{status:"failed"};const{userErrors:d,shopToken:u}=s.paymentSelectionCreate;return d.length>0||null==u?(n.leaveErrorBreadcrumb("Payment selection create mutation failed due to user errors"),{status:"failed",errors:d}):(n.leaveErrorBreadcrumb("Payment selection create mutation succeeded"),{status:"success",sessionId:u})}));return function(e){return o.apply(this,arguments)}}(),[r,e,n,t])}(),{source:d}=s(),u="shopPayExternal"===d.type,{shippingRequired:c}=T(),p=P.installmentsPayment.value,h=P.selectedPaymentMethod.value,m=P.selectedShippingAddress.value,g=P.addresses.value,y=function(){var i=a((function*(){if("CREDIT_CARD"!==(null==h?void 0:h.paymentMethod))return{errors:[{field:["selectedCreditCard"],message:"Payment Method different than Credit Card"}]};const a=null==h?void 0:h.paymentAttributes;if(!a)return{errors:[{field:["selectedCreditCard"],message:or}]};const i=null==m?void 0:m.id,s=!g.some((e=>!!m&&$n(e.address,null==m?void 0:m.address))),l={addressId:c&&!s?i:void 0,creditCardId:a.id};if(u){const n=p?{autoPayEnabled:p.autopay_enabled,disclosures:p.disclosures,installmentsToken:p.token,sellerId:p.seller_id}:void 0,a=t(t({},l),{},{installmentsParams:n});if(e.stripeConfig.isStripeExpress)return o(a);{var d,y,f;const o={shippingRequired:c,isEphemeralAddress:s,selectedShippingAddressId:null==m?void 0:m.id,hasVaultedAddresses:g.length>0,checkoutUrl:null===(d=e.sessionDetails)||void 0===d?void 0:d.checkoutUrl,supportedDeliveryMethodTypes:null===(y=e.paymentRequest)||void 0===y||null===(y=y.deliveryMethods)||void 0===y?void 0:y.map((e=>e.code)),selectedDeliveryMethodType:null===(f=e.paymentRequest)||void 0===f?void 0:f.selectedDeliveryMethodType};return r(t(t({},l),{},{installmentsParams:n,debugContext:o}))}}const v=p?{disclosuresEvidence:p.disclosures[0].evidence,paymentTermToken:p.token,sellerId:p.seller_id}:void 0;return n(t(t({},l),{},{installmentsAgreements:v,unvaultedShippingAddress:s?null==m?void 0:m.address:void 0}))}));return function(){return i.apply(this,arguments)}}();return y}(),E=function(){const{value:e}=N(),{billingAddress:n,billingAddressOption:t}=J(),r=Cn(),o=Sn("shipping"===t.value?r:n.value);return({agreementToken:n,sessionToken:t}={})=>({method:{type:"wallet",name:"SHOP_PAY",walletContent:kn({sessionToken:t,agreementToken:n,billingAddress:o,negotiatedPaymentMethods:e})}})}(),x=function(){const{telemetryClient:e}=s(),n=e=>{P.negotiationProgressError.value=e};return t=>t===In.CheckingShippingRequirement?{behavior:"block",reason:In.CheckingShippingRequirement,perform(){n(En.CheckingShippingRequirement)}}:t===In.CalculatingTaxes?{behavior:"block",reason:In.CalculatingTaxes,perform(){n(En.CalculatingTaxes)}}:t===In.MissingCreditCard?{behavior:"block",reason:In.MissingCreditCard,perform(){n(En.MissingCreditCard)}}:t===In.InstallmentsFailed?{behavior:"block",reason:In.InstallmentsFailed,perform(){n(En.MissingInstallmentsBillingAddress)}}:t===In.ShopPayPaymentFailed?{behavior:"block",reason:In.ShopPayPaymentFailed,perform(){n(En.SubscriptionsBillingAgreementFailed)}}:t===In.PaymentMethodNotAllowed?{behavior:"block",reason:In.PaymentMethodNotAllowed,perform(){n(En.PaymentMethodNotAllowed)}}:(e.error(new he(`Unhandled invalid result reason ${t} identified during Shop Pay negotiation intercept`,{groupingHash:"ShopPayError::UnhandledInvalidResult"}),{severity:"error"}),{behavior:"block",reason:t})}(),A=function(){const{layout:e}=ee();return n=>{"verification_required"!==n?P.negotiationProgressError.value="error"!==n||"web"!==e?En.ProcessingError:En.ProcessingErrorCheckoutAsGuest:P.showSessionRevalidator.value=!0}}(),B=$(),{value:M}=N(),{replaceShopPayInHistory:L}=Qn(),D=Y(),{value:U}=Un(),R=De(Ue),z=Kn(),j=({parts:e})=>{if(f&&v){const n=e.shopPayArtifact.peek()||{};e.shopPayArtifact.value=t(t({},n),{},{shopUser:t(t({},(null==n?void 0:n.shopUser)||{}),{},{uuid:v})})}},q=({parts:e,agreementToken:n,sessionToken:t})=>{var r;if(null==M||!M.find((e=>"wallet"===e.type&&"SHOP_PAY"===e.name)))return;const o=e.paymentLines.value,a=null===(r=o[0])||void 0===r?void 0:r.method;Xn(a,M)||qn(a)||(e.paymentLines.value=jn(o,E({agreementToken:n,sessionToken:t})))},H=({parts:e})=>{C&&(e.shopPayArtifact.value={cashBack:{token:C.token}})};Rn(function(){var i=a((function*({parts:a,reason:i}){var s,l,f;if(c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept enter",{reason:i}),P.negotiationProgressError.value=null,"negotiation"===i)return{behavior:"allow"};if(z&&!m)return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - no payment required"),{behavior:"allow",perform(){q({parts:a}),j({parts:a}),H({parts:a}),(({parts:e})=>{var n;if(null==_||!_.address||!z||m)return;const t=(null===(n=e.shippingAddress.value)||void 0===n?void 0:n.countryCode)||_.address.countryCode,r=lr(_.address,t,D,P.phoneNumber.value,c);e.billingAddress.value=r})({parts:a})}};if(e.peek().has("isShippingRequired"))return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - checking shipping requirement"),x(In.CheckingShippingRequirement);if(e.peek().has("taxes"))return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - calculating taxes"),x(In.CalculatingTaxes);const v=a.paymentLines.peek(),C=zn(g,v,R);if(!C)return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - missing payment method"),x(In.MissingCreditCard);const I=w(C);if(y&&(null==I||!I.billingAddress))return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - installments missing billing address"),x(In.InstallmentsFailed);const E=(null===(s=a.shippingAddress.value)||void 0===s?void 0:s.countryCode)||b.countryCode;a.billingAddress.value=lr(b,E,D,P.phoneNumber.value,c);const T=yield k();if(T&&"errors"in T){var N;const e=T.errors&&(null===(N=T.errors[0])||void 0===N?void 0:N.message);e===or&&c.error(new ir(e),{severity:"error",metadata:{paymentLines:{types:v.map((e=>e.method.type))},paymentSelected:{value:JSON.stringify(C)},selectedPaymentMethod:{paymentMethod:C.paymentMethod,paymentMethodId:C.id,paymentAttributes:"paymentAttributes"in C&&C.paymentAttributes?JSON.stringify(C.paymentAttributes):void 0}}})}if(Fn(T))return r.record({schemaId:"shopify_pay_checkout_error/1.2",payload:t(t({},te(o,d,u)),{},{errorType:`Shop Pay appears to be down. Http Status code: ${T.statusCode}.`})}),c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - Shop Pay down"),L(S),{behavior:"block",reason:In.ShopPayPaymentFailed};if(!T||"failed"===T.status)return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - Shop Pay payment session failed"),{behavior:"block",reason:In.ShopPayPaymentFailed,perform(){var e;A(null==T||null===(e=T.errors)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.message)}};const $=B&&C&&O(C),G="CUSTOM_ONSITE"===(null==C?void 0:C.paymentMethod),Y=F(C);if((n||m)&&!y&&!$&&!G&&(null==T||null===(l=T.batchCheckoutSessionIds)||void 0===l||!l.length)&&!Y){const e=yield p(C.id);return e&&"failed"!==e.status?(c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - Post Purchase Shop Pay payment success"),{behavior:"allow",perform(){q({parts:a,agreementToken:e.billingAgreementToken,sessionToken:T.sessionId}),H({parts:a}),j({parts:a})}}):(c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - Post Purchase Shop Pay payment failed"),x(In.ShopPayPaymentFailed))}if(y&&null!=I&&I.billingAddress.address){var J,V;const{autopay_enabled:e,disclosures:n,token:t}=y,r={autoPayEnabled:e,billingAddress:Sn(b),disclosureDetails:n,installmentsToken:t,sessionToken:T.sessionId,paymentMethodIdentifier:null!==(J=null===(V=h.config)||void 0===V?void 0:V.paymentMethodIdentifier)&&void 0!==J?J:""};return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - installments allowed"),{behavior:"allow",perform(){const e=a.paymentLines.peek();a.paymentLines.value=jn(e,{method:{type:"wallet",name:"SHOPIFY_INSTALLMENTS",walletContent:r}}),H({parts:a}),j({parts:a})}}}if($&&!ar(M))return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - ideal payment method not allowed"),x(In.PaymentMethodNotAllowed);if(T.batchCheckoutSessionIds&&(null===(f=T.batchCheckoutSessionIds)||void 0===f?void 0:f.length)>0)for(const{shopId:e,sessionId:n}of T.batchCheckoutSessionIds){const r=null==U?void 0:U.get(e);r&&(null==U||U.set(e,t(t({},r),{},{sessionId:n})))}return c.leaveErrorBreadcrumb("Shop Pay Negotiation Intercept - complete and allow"),{behavior:"allow",perform(){q({parts:a,sessionToken:T.sessionId}),H({parts:a}),j({parts:a})}}}));return function(e){return i.apply(this,arguments)}}())}();const{layout:e}=ee(),{shopPay:{visibility:{shouldRenderFloatingShopPayButton:n}},mobileCheckoutSdk:r}=s(),o=!r.variant.isPartner()&&"app"===e,u=I(),c=u.supported&&u.paymentMethodSelected?Xt:Mt;return n?d(Yn,{children:d(ur,{children:d(c,{})})}):o?d(Yn,{children:d(Jn,{children:d(c,{})})}):d(c,{})}));var at=(e=>(e.BlankEmail="blank_email",e.BlankPhone="blank_phone",e.InvalidEmail="invalid_email",e.InvalidPhone="invalid_phone",e.ShopAccountsInvalidEmail="shop_accounts_invalid_email",e.ShopAccountsInvalidPhone="shop_accounts_invalid_phone",e.ShopAccountsPhoneLimitReached="shop_accounts_phone_limit_reached",e))(at||{});const it={id:"809c480d17a1bef2080b76b2aa6165549a9c2b94c800ad4841b3f4dd980b6dba",type:"mutation",name:"CreateVerification",source:"mutation CreateVerification($checkoutSessionIdentifier:String,$origin:String!,$shopifyDomain:String){verificationCreate(checkoutIdentifier:$checkoutSessionIdentifier origin:$origin shopifyDomain:$shopifyDomain){token phoneLastDigits phone userErrors{field message __typename}__typename}}"},st={id:"bc76dd6479072a30d5b57f05e96490e4a4f423494978924d792aabd471e73c60",type:"mutation",name:"SessionRevalidate",source:"mutation SessionRevalidate($code:String!,$origin:String!,$token:String!){sessionRevalidate(code:$code,origin:$origin,token:$token){accessToken userErrors{field message __typename}__typename}}"},lt={DoubleSpinnerIcon:"nuxWF",Circle:"AfOP8",light:"pqnj6",inner:"i4kx9",outer:"ttRly"};function dt({ariaLabel:e,light:n=!1,size:t=32}){const r={width:`${t}px`,height:`${t}px`};return d(c,{children:[e&&d("span",{role:"status",className:"visuallyHidden",children:e}),d("div",{className:lt.DoubleSpinnerIcon,style:r,"aria-hidden":"true",children:[d("div",{className:u(lt.Circle,lt.outer,n&&lt.light),children:ut("M0 15c0 8.284 6.716 15 15 15 8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15a1 1 0 0 0 0 2c7.18 0 13 5.82 13 13s-5.82 13-13 13S2 22.18 2 15a1 1 0 0 0-2 0z")}),d("div",{className:u(lt.Circle,lt.inner,n&&lt.light),children:ut("M4 15c0 6.075 4.925 11 11 11s11-4.925 11-11S21.075 4 15 4a1 1 0 0 0 0 2 9 9 0 1 1-9 9 1 1 0 0 0-2 0z")})]})]})}function ut(e){return d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 30 30",width:"100%",height:"100%",children:d("path",{d:e})})}const ct={CodeBoxesWrapper:"MEXbs",CodeBox:"O2SWd",Focused:"tMP9u",Success:"A7Hsz",Error:"oUUJk"};function pt({focusedBox:e,codeInput:n,maxLength:t,success:r,error:o}){return d("div",{className:ct.CodeBoxesWrapper,children:[...Array(t).keys()].map((t=>{const a=e===t,i=t<n.length?n[t]:"";return d("span",{className:u(ct.CodeBox,a&&ct.Focused,r&&ct.Success,o&&ct.Error),children:i},t)}))})}const ht={CodeInputWrapper:"XbKGE",CodeInput:"_21xeZ"},mt=/^\d*$/,gt=6;function yt({onCodeEntered:e,onClear:n,ariaLabel:t,loading:r,success:o,error:a,maxLength:i=gt}){const s=p(null),[l,c]=h(""),[y,f]=h(0);function v(e){f(e.currentTarget.selectionEnd||0)}return m((()=>{var n;l.length===i&&(null===(n=s.current)||void 0===n||n.blur(),e(l))}),[l,e,i]),m((()=>{var e;null===(e=s.current)||void 0===e||e.focus()}),[a]),m((()=>{l.length<i&&(o||a)&&n()}),[i,l,o,a,n]),d("div",{className:u(ht.CodeInputWrapper,g({colorLayer:"control"})),children:[d("input",{ref:s,className:ht.CodeInput,"aria-label":t,disabled:r,type:"tel",autoComplete:"one-time-code",maxLength:i,value:l,onInput:function(e){const{value:n,selectionEnd:t}=e.currentTarget;r?e.currentTarget.value=l:mt.test(n)?(c(n),f(t||0)):e.currentTarget.value=l},onSelect:v,onClick:v,onKeyUp:v,autoFocus:!0}),d(pt,{focusedBox:y,codeInput:l,maxLength:i,success:o,error:Boolean(a)})]})}const ft={Footer:"iNU0B"},vt=({description:e,onClose:n})=>{const{i18n:t}=s(),{href:r,onClick:o}=y(),a=l((()=>{o(),window.location.assign(r)}),[r,o]);return d(c,{children:[d(f,{padding:["none","none","base","none"],children:d(v,{children:e})}),d(_,{padding:["none","none","small200","none"],children:[d(b,{variant:"primary",inlineSize:"fill",onClick:a,children:t.translate("shop_pay.checkout.continue_to_guest_checkout")}),d(b,{variant:"plain",inlineSize:"fill",onClick:n,children:t.translate("shop_pay.address_form.cancel")})]})]})};function _t({onComplete:e,onDismiss:n}){const{i18n:t}=s(),[r,o]=h(""),[u,p]=h("loading"),[g,y]=h(!1),S=P.sessionVerified,k=function(){const e=i(),{shop:{myshopifyDomain:n},source:{checkoutSessionIdentifier:t}}=s();return l(function(){var r=a((function*(r){const{data:o,error:a}=yield e.mutate(it,{variables:{checkoutSessionIdentifier:t,origin:r,shopifyDomain:n}});if(a||null==o||null==o.verificationCreate)return{status:"failed"};const{verificationCreate:i}=o;return i.userErrors.length>0?{status:"failed",errors:i.userErrors}:{status:"success",phone:i.phone,phoneLastDigits:i.phoneLastDigits,verificationToken:i.token}}));return function(e){return r.apply(this,arguments)}}(),[e,t,n])}(),I=function(){const e=i();return l(function(){var n=a((function*(n,t,r){const{data:o,error:a}=yield e.mutate(st,{variables:{code:n,origin:t,token:r}});if(a||null==o||null==o.sessionRevalidate)return{status:"failed"};const{sessionRevalidate:i}=o;return i.userErrors.length>0?{status:"failed",errors:i.userErrors}:{status:"success",accessToken:i.accessToken||void 0}}));return function(e,t,r){return n.apply(this,arguments)}}(),[e])}(),E=l((e=>{var n;null!==(n=e.errors)&&void 0!==n&&n.some((e=>"limit_exceeded"===(null==e?void 0:e.message)))&&y(!0),p("error")}),[]);m((()=>{const e=function(){var e=a((function*(){try{const e=yield k("session-revalidate");"success"===e.status?(o(e.verificationToken||""),p("idle")):"failed"===e.status&&E(e)}catch(e){p("error")}}));return function(){return e.apply(this,arguments)}}();e()}),[k,E]);const x=l(function(){var n=a((function*(n){if(r)try{var t;p("loading");const o=yield I(n,"session-revalidate",r);if("success"===o.status)return p("success"),S.value=!0,e();null!==(t=o.errors)&&void 0!==t&&t.length&&E(o)}catch(o){p("error")}}));return function(e){return n.apply(this,arguments)}}(),[e,I,r,E,S]),A=l((()=>{p("idle")}),[]);let w;return w="error"===u?d(v,{tone:"critical",children:t.translate("shop_pay.checkout.authorize_incorrect_code")}):"loading"===u?d(dt,{}):d(b,{onClick:n,variant:"plain",children:d(f,{padding:"base",children:t.translate("shop_pay.address_form.cancel")})}),d(C,{open:!0,heading:g?t.translate("shop_pay.checkout.authorize_limit_exceeded_title"):t.translate("shop_pay.checkout.title_authorize"),onHide:n,closeButton:"hidden",children:g?d(vt,{description:t.translate("shop_pay.checkout.authorize_limit_exceeded"),onClose:n}):d(c,{children:[d(f,{padding:["none","none","base","none"],children:d(v,{children:t.translate("shop_pay.checkout.authorize_instructions")})}),d(_,{inlineAlignment:"center",spacing:"small400",children:[d(yt,{onCodeEntered:x,onClear:A,ariaLabel:t.translate("shop_pay.checkout.authorize_instructions"),success:"success"===u,error:"error"===u}),d("div",{className:ft.Footer,children:w})]})]})})}const bt=()=>{const e=P.signUpPhoneNumber.value,n=P.signUpPhoneCountryCode.value,{isPhoneNumberUtilLoaded:t,validatePhoneNumber:r}=S(),{isPayUserAvailable:o}=k();return{missingRequiredMobilePhoneNumber:Boolean(!o&&(!e||t&&!r(e,n,!0)))}};function Pt(){const{monorail:e,source:n,checkout:r,shop:o,shopPay:a}=s(),{shopPayCheckoutSurface:i}=ee(),l=function(){const{telemetryClient:e,shopPay:n}=s(),{loading:t}=M(),{loading:r}=T(),{loading:o}=X(),{shopPayParts:a}=Z(),i=Boolean(a.installmentsPayment.value),l=a.paymentMethodOption.value,d="SHOPIFY_INSTALLMENTS"===(null==l?void 0:l.name)&&null===n.deviceFingerprint,u=Q().redemption.applying.value,c=t||r||o||u||i||d;return tt({enabled:c,onTimeout:n=>{e.counter({name:"shop_pay_progress_button_loading_timeout",value:1}),e.log("shop_pay_progress_button_loading_timeout","Shop Pay progress button loading timeout",{timeout:n,deliveryLoading:t,shippingRequiredLoading:r,taxesLoading:o,shopCashRedemptionLoading:u})}}),c}(),{isUnauthenticatedSession:d}=k(),u=function(){const{loading:e,value:n}=M(),{shippingRequired:t}=T();return!!t&&!e&&"unavailable"===(null==n?void 0:n.status)}(),c=function(){const{value:e}=M(),{shippingRequired:n}=T(),{shippingCountries:t}=G(),r=Y(void 0,"shipping"),{shippingAddress:o}=J(),a=P.selectedShippingAddress.value,i=o.value,s=V(i.countryCode,t,r)(i,"shipping").size>0,l=W(e,"ONE_TIME_PURCHASE",!0),d=K(l),u="PICK_UP"===(null==d?void 0:d.methodType);return!(!n||u)&&!a&&(!i||s)}(),h=function(){const e=x(),n=P.storedCreditCards.value.map((e=>e.paymentAttributes)),t=P.selectedFreeCheckoutBillingAddress.value,r=P.selectedPaymentMethod.value,o=w(r),a=R(),{hasViolations:i}=z(q);if(i)return!0;if(!e&&!o&&!n.length)return!1;const s=e&&!1===(null==t?void 0:t.valid);if(r&&F(r))return!a||Boolean(s);if(r&&(O(r)||j(r)))return Boolean(s);const l=!(e||null!=o&&o.billingAddressValid);return s||l}(),g=function(){var e;const n=I(),{creditCardDisabled:t}=E(),r=x(),o=A(),a=P.selectedPaymentMethod.value,i=w(a),s=Boolean(B(null===(e=n.config)||void 0===e?void 0:e.availableLoanTypes,null==i?void 0:i.supportsInstallmentsSplitPayLoan,null==i?void 0:i.supportsInstallmentsInterestLoan)),l=Boolean(n.paymentMethodMustSupportInterestBearingLoans&&o.value.every((e=>t(e))))||!r&&!i&&0===o.value.length;return Boolean(n.paymentMethodSelected)&&!s&&!l}(),{missingRequiredMobilePhoneNumber:y}=bt(),f=function(){const e=P.selectedPaymentMethod.value,n=w(e),t=H(),r=t.value&&t.value.amount>0;return Boolean((null==n?void 0:n.expired)&&r)}(),v=function(){const{value:e}=N(),n=$(),t=L(),r=P.selectedPaymentMethod.value;return D((()=>!!r&&!!O(r)&&!U(t,n,e)),[r,t,n,e])}(),_=I(),{isSelectedPaymentMethodSupported:b,label:C}=ne(),S=!_.paymentMethodSelected&&!1===b&&Boolean(C),re=P.checkoutErrors.value,oe=P.createUnverifiedUserErrors.value,ae=P.shopAccountUuid.value,ie=a.invalidCheckoutState,se=p(0),le=p(null),de=Boolean(re.delivery[0]),ue=Boolean(re.payments[0]),ce=!d&&(u||c||de||ue||h||g||f||v||S||ie);return m((()=>{l||(se.current++,e.record({schemaId:"shopify_pay_payment_page_pay_now_state/3.0",payload:t(t({},te(n,r,o)),{},{shopAccountUuid:ae,counter:se.current,deliveryValueIncomplete:u,shippingInformationIncomplete:c,hasDeliveryCheckoutError:de,hasPaymentCheckoutError:ue,hasCreateUnverifiedUserError:Boolean(oe[0]),paymentInformationIncomplete:h,installmentChecksIncomplete:g,missingMobilePhoneNumber:y,paymentMethodExpired:f,idealPaymentUnsupported:v,cardBrandUnsupported:S})}))}),[l,e,n,r,o,ae,u,c,de,ue,h,oe,g,f,y,v,S,ie]),m((()=>{if(l||ce===le.current)return;le.current=ce;const a=ce?"pay_now_button_disabled":"pay_now_button_enabled";e.record({schemaId:"shopify_pay_payment_page_ready/2.1",payload:t(t({},te(n,r,o)),{},{success:!0,status:a,clientTimestampMs:Date.now()})})}),[e,n,r,o,l,ce,i]),l||ce}function Ct(){const{i18n:e}=s(),{href:n,onClick:t}=y(re.PaymentErrorState),{shopPayParts:r}=Z();return 0===r.createUnverifiedUserErrors.value.length?null:d(ae,{tone:"critical",children:d(_,{inlineAlignment:"start",spacing:"small500",children:d(v,{children:e.translate("shop_pay.account_creation_error",{check_out_as_guest_link:d(oe,{href:n,onClick:t,tone:"monochrome",children:e.translate("shop_pay.checkout.checkout_guest")})})})})})}function St(){const{i18n:e,shop:n,shopPay:t}=s();return(n.enabledFlags.includes(ie)?t.isUnauthenticatedUser:"unauthenticated_user"===P.flow.value)?d(v,{type:"small",color:"subdued",children:e.translate("shop_pay.checkout.sign_up_footer.terms_and_privacy_html",{privacy_href:d(oe,{target:"_blank",href:"https://www.shopify.com/legal/privacy/app-users",children:e.translate("shop_pay.checkout.sign_up_footer.privacy_policy")}),terms_href:d(oe,{target:"_blank",href:"https://shop.app/terms-of-service",children:e.translate("shop_pay.checkout.sign_up_footer.terms_of_service")})})}):null}function kt({formattedAmount:e,nextPageLabel:n}){const{layout:t}=ee(),r="app"===t;return e?d(de,{columns:["fill","auto","auto"],spacing:"base",children:[d(se,{ignoreBranding:r,children:n}),d(le,{direction:"block"}),d(se,{ignoreBranding:r,children:e})]}):d(se,{ignoreBranding:r,children:n})}function It(){const{telemetryClient:e,source:n}=s(),{currentDetour:t,currentPage:r}=ue(),o=ce(),{nextPage:a,previousPage:i}=pe();return D((()=>({ensureShopPayURL:()=>{r||o.navigate("/shoppay",{replace:!0})},leaveBreadcrumb:n=>{e.leaveErrorBreadcrumb(n,{currentDetour:JSON.stringify(t),currentPage:JSON.stringify(r),nextPage:JSON.stringify(a)})},logError:(o,{result:s}={})=>{e.error(new he(o,{groupingHash:"ShopPayError::InvalidPageLogger"}),{severity:"error",metadata:{source:{type:n.type},checkout:{token:n.checkoutSessionIdentifier||n.sourceId},event:{currentDetour:JSON.stringify(t),currentPage:JSON.stringify(r),nextPage:JSON.stringify(a),previousPage:JSON.stringify(i),result:JSON.stringify(s)}}})}})),[t,r,e,a,i,o,n.checkoutSessionIdentifier,n.sourceId,n.type])}const Et="Mobile phone number is missing or invalid";function xt(){const{monorail:e,shop:n,source:r,checkout:o,telemetryClient:i}=s(),d=Se(),{createUnverifiedUser:u}=function(){const{email:e,emailError:n}=function(){const e=P.email.value,{email:n}=J(),t=n.value,{shop:r,shopPay:{userVerification:o,isEmailOnlySignup:a}}=s(),i=((r.enabledFlags.includes(ie)?a:"email_only_signup"===P.flow.value)?e:t).trim(),l=D((()=>{const e=ge(i,at.BlankEmail),n=ye(i,at.InvalidEmail),t="invalid"===o.status?at.InvalidEmail:void 0;return e||n||t}),[i,o.status]);return{email:i,emailError:l}}(),{isPayUserAvailable:t}=k(),{clearEmailOnlySignUp:r,sharedHCaptchaToken:o,setSharedHCaptchaToken:i}=fe(),[d,u]=ve(),{source:{checkoutSessionIdentifier:c},url:p,shop:h,shopPay:m}=s(),g=h.enabledFlags.includes(ie),{transaction_params:y}=ee(),{missingRequiredMobilePhoneNumber:f}=bt(),v=l(a((function*(a=!0){if(t||d)return{status:"skipped"};if(!y)return{status:"failed",errors:[{field:[],code:"missing_content",message:"Transaction params are missing"}]};const s=[];if(n&&s.push({field:["email"],code:n,message:"email is blank or invalid"}),f&&s.push({field:["phone"],code:at.InvalidPhone,message:Et}),s.length>0)return{status:"failed",errors:s};let l=a?o:void 0;if(!l)try{var h;const e=yield null===(h=P.signUpCaptchaRef.value)||void 0===h?void 0:h.execute({async:!0});e&&(l=e.response)}catch(C){return"challenge-closed"===C?{status:"failed",errors:[]}:{status:"failed",errors:[{field:["hcaptcha"],code:String(C),message:"A captcha error was caught and handled"}]}}let _=null;try{_=yield fetch(p.shopPayCreateUnverifiedUser(),{method:"POST",body:JSON.stringify({email:e,phone:P.signUpPhoneNumber.value||"",hcaptcha_token:l,origin:"c1_unverified_user_signup",checkout_token:c,transaction_params:y}),headers:{"Content-Type":"application/json",accept:"application/json"}})}catch(C){return{status:"failed",errors:[{field:[],code:"unknown_error",message:"An error was caught and handled during API request"}]}}const b=yield _.json();return 200!==_.status?Array.isArray(null==b?void 0:b.errors)&&1===(null==b?void 0:b.errors.length)&&"further_authorization_required"===(null==b?void 0:b.errors[0].code)&&a?(i(void 0),v(!1)):{status:"failed",errors:(null==b?void 0:b.errors)||[{field:[],code:`response_with_http_error_${_.status}`,message:"Failed to create user"}]}:(u(b.parsed_phone),P.email.value=e,g?m.unstable_updateFlow("authenticated_user"):P.flow.value="authenticated_user",r(),{status:"success"})})),[t,d,y,n,f,o,u,e,g,m,r,p,c,i]);return{createUnverifiedUser:v}}(),{handleCreateUnverifiedUserErrors:c}=function(){const{i18n:e,monorail:n,source:r,checkout:o,shop:a,shopPay:i}=s(),l=_e(),{openModal:d}=be(),u=a.enabledFlags.includes(ie)?i.isEmailOnlySignup:"email_only_signup"===P.flow.value,c={[at.BlankEmail]:e.translate("field_errors.email_blank"),[at.InvalidEmail]:e.translate("field_errors.email_invalid"),[at.ShopAccountsInvalidEmail]:e.translate("field_errors.email_invalid")},p={[at.BlankPhone]:e.translate("shop_pay.mobile_phone_number.mobile_phone_invalid"),[at.InvalidPhone]:e.translate("shop_pay.mobile_phone_number.mobile_phone_invalid"),[at.ShopAccountsInvalidPhone]:e.translate("shop_pay.mobile_phone_number.mobile_phone_invalid"),[at.ShopAccountsPhoneLimitReached]:e.translate("shop_pay.mobile_phone_number.phone_limit_reached")};return{handleCreateUnverifiedUserErrors:e=>{if(0===e.length)return;const i=e.map((e=>e.code));i.forEach((e=>{n.record({schemaId:"shopify_pay_checkout_error/1.2",payload:t(t({},te(r,o,a)),{},{errorType:`create_unverified_user/${e}`})})}));const s=c[i.find((e=>e in c))],h=p[i.find((e=>e in p))];return s||h?(Pe.value=s,P.signUpPhoneError.value=h):u?P.createUnverifiedUserErrors.value=e:d({type:Ce.Generic}),Promise.resolve().then((()=>l()))}}}(),p=_e(),h=l(a((function*(){try{const a=yield u(),s=yield d.runInterceptors(),l=ke(s);if(!l){const a=Ie(s);a.forEach((a=>{e.record({schemaId:"shopify_pay_checkout_error/1.2",payload:t(t({},te(r,o,n)),{},{errorType:a})})})),i.log("shop_pay_progress_interceptor_error_reported","Shop Pay progress interceptor reported an error in useShopPayProgressContinue",{interceptorErrors:a})}if("failed"===(null==a?void 0:a.status))return c(a.errors),!1;if(!l)return function(e){Promise.resolve().then((()=>e()))}(p),!1}catch(s){var a;return Ee(s.message)||i.error(s,{errorClass:xe.ShopPayProgressIntercept,severity:"error",metadata:{source:{type:r.type},checkout:{token:null!==(a=r.checkoutSessionIdentifier)&&void 0!==a?a:"checkout_identifier_undefined"}}}),!1}return!0})),[u,p,c,d,e,r,o,n,i]);return{progressContinue:h}}const At=()=>{const{telemetryClient:e,source:n}=s(),r="shopPayExternal"===n.type,o=Ae(),a=we();return l((()=>{if(!r)return;let n=!1,i=!1;for(const e of o.validationErrors.value)e.target===Be.generalError?n=!0:e.target===Be.shippingAddressError&&(i=!0);(n||i)&&e.counter({name:"shop_pay_external_checkout_with_address_errors",value:1,attributes:t({hasGeneralError:n,hasDeliveryAddressError:i},Me(null==a?void 0:a.stripeConfig))})}),[r,a.stripeConfig,e,o.validationErrors])};function wt(){const e=It(),{monorail:n,source:r,checkout:o,shop:i,telemetryClient:d}=s(),{pageLoadId:u}=te(r,o,i),c=Zn(),{progress:p,progressing:h}=Te(),{nextPage:g}=pe(),y=me("simulated"),{progressContinue:f}=xt(),v=Ne(),_=P.internalProgressing,b=P.buttonProgressing,C=$e(),S=At();return m((()=>{_.value=b.value||!C&&h}),[_,C,h,b.value]),{onPress:l(a((function*(){if(d.leaveErrorBreadcrumb("Shop Pay Progress Button Press"),y)d.leaveErrorBreadcrumb("Shop Pay Progress Button Press - simulated");else{if(c)return d.leaveErrorBreadcrumb("Shop Pay Progress Button Press - requires verification"),void(P.showSessionRevalidator.value=!0);S(),n.record({schemaId:"shopify_pay_payment_page_pay_now/2.1",payload:t(t({},te(r,o,i)),{},{clientTimestampMs:Date.now(),pageLoadId:u})});try{b.value=!0,(yield f())?(d.leaveErrorBreadcrumb("Shop Pay Progress Button Press - progress"),yield p("shop-pay-progress-button-press",(n=>{d.leaveErrorBreadcrumb("Shop Pay Progress Button Press - progression",{status:n.status,nextPageId:g.id}),"thankYou"!==g.id&&e.logError("Shop Pay button triggered progression when next page is not `thankYou`",{result:n})}),{onProgressBlocked:()=>{d.leaveErrorBreadcrumb("Shop Pay Progress Button Press - progress blocked",{nextPageId:g.id}),e.ensureShopPayURL()}}),v.notify({checkout_in_progress:!0})):(d.leaveErrorBreadcrumb("Shop Pay Progress Button Press - progress continue failed",{nextPageId:g.id}),"thankYou"!==g.id&&(e.logError("Shop Pay button is pressed when next page is not `thankYou`"),e.ensureShopPayURL()))}finally{b.value=!1}}})),[d,e,y,g,u,p,f,n,r,o,i,c,v,b,S])}}function Bt(){const e=Se(),{monorail:n,source:r,checkout:o,shop:i,telemetryClient:l}=s(),d=_e(),{progress:u}=Te(),c=function(){var s=a((function*(){P.showSessionRevalidator.value=!1;const a=yield e.runInterceptors();if(!ke(a)){const e=Ie(a);return e.forEach((e=>{n.record({schemaId:"shopify_pay_checkout_error/1.2",payload:t(t({},te(r,o,i)),{},{errorType:e})})})),l.log("shop_pay_session_revalidated","Shop Pay progress interceptor reported an error in useShopPaySessionRevalidation",{interceptorErrors:e}),void function(e){Promise.resolve().then((()=>e()))}(d)}u("shop-pay-session-revalidation")}));return function(){return s.apply(this,arguments)}}();return c}function Mt(){const{i18n:e,mobileCheckoutSdk:n}=s(),t=function(){const{i18n:e}=s(),n=It(),t=Zn(),{nextPage:r}=pe(),o=me("simulated"),a=$(),i=Vn();return m((()=>{o||"thankYou"===r.id||n.leaveBreadcrumb(`Unexpected: ShopPay pay button was rendered when next page is "${r.id}" and not "thankYou"`)}),[r.id,r.label]),t?e.translate("shop_pay.checkout.authorize_purchase"):a&&"IDEAL"===i?e.translate("shop_pay.checkout.continue_to_payment"):r.label}(),r=Pt(),{onPress:o}=wt(),{shopPayParts:a}=Z(),i=a.showSessionRevalidator,u=Bt(),{layout:c}=ee(),{value:p}=H(),h=et(),g=a.internalProgressing.value,{setPayNowButtonElement:y}=Le(),f=De(Oe),v=De(Ue),P=Re()&&v,C=ze(),S=D((()=>n.enabled&&n.variant.isStandard()?null:"app"===c&&p&&t===e.translate("general.pay_now_button_label")?e.formatCurrency(p.amount,{currency:p.currencyCode,form:"short"}):null),[e,c,t,p,n]),k=l((()=>{i.value=!1}),[i]);return d(_,{children:[d("div",{className:h,children:C?d(Fe,{onPress:o,loading:g,disabled:r}):P?d(je,{disabled:r,loading:g,pixelId:"pay_button"}):d(b,{variant:"primary",inlineSize:"fill",onClick:o,loading:g,loadingMode:f?"extended":"auto",disabled:r,inlineAlignment:S?"start":"center",accessibilityLabel:S?`${t}\n${S}`:t,ref:y,children:d(kt,{formattedAmount:S,nextPageLabel:t})})}),d(St,{}),d(Ct,{}),i.value&&d(_t,{onComplete:u,onDismiss:k})]})}const Tt={id:"cd6d43f347882cdb1ee945c81adbe3db0cebf178208a11c617734afa18a05516",type:"query",name:"SupportedLocalesQuery",source:"query SupportedLocalesQuery($countryCode:String!){installmentsSupportedLocales(countryCode:$countryCode){locales default __typename}}"},Nt=(e,n)=>{const t=new Intl.DisplayNames([e],{type:"language"});return n.map((e=>{var n;return null!==(n=t.of(e))&&void 0!==n?n:e}))},$t={AffirmLogo:"gwGKY"},Lt=e=>d("svg",t(t({xmlns:"http://www.w3.org/2000/svg",width:40,height:18},e),{},{children:[d("path",{d:"M3.058 14.543c-.482 0-.724-.236-.724-.623 0-.72.812-.965 2.292-1.121 0 .962-.656 1.744-1.569 1.744zm.638-5.413c-1.058 0-2.275.495-2.936 1.017l.604 1.26c.53-.48 1.386-.892 2.159-.892.734 0 1.14.243 1.14.734 0 .33-.269.497-.777.563C1.99 12.056.5 12.575.5 14.026c0 1.15.826 1.846 2.116 1.846.92 0 1.74-.507 2.129-1.176v.99H6.46v-4.148c0-1.712-1.2-2.408-2.764-2.408m17.224.188v6.367h1.837v-3.068c0-1.458.89-1.886 1.51-1.886.243 0 .57.07.785.23l.334-1.684a2.1 2.1 0 0 0-.822-.147c-.944 0-1.538.415-1.929 1.258v-1.07h-1.714zm12.979-.188c-.971 0-1.697.57-2.075 1.118-.35-.709-1.093-1.118-1.983-1.118-.971 0-1.643.535-1.954 1.15v-.962h-1.77v6.367h1.838v-3.277c0-1.177.621-1.742 1.201-1.742.525 0 1.007.337 1.007 1.207v3.812h1.835v-3.277c0-1.19.606-1.742 1.213-1.742.486 0 .998.35.998 1.193v3.826h1.834v-4.401c0-1.431-.971-2.154-2.144-2.154m-17.447.187h-1.664v-.648c0-.842.485-1.083.903-1.083.462 0 .822.203.822.203l.566-1.284s-.573-.372-1.617-.372c-1.173 0-2.508.656-2.508 2.716v.468h-2.785v-.648c0-.842.485-1.083.903-1.083.238 0 .557.054.822.203l.566-1.284c-.338-.196-.88-.372-1.617-.372-1.173 0-2.508.656-2.508 2.716v.468H7.269v1.405h1.066v4.963h1.834v-4.963h2.785v4.963h1.834v-4.963h1.664zm1.095 6.367h1.832V9.317h-1.832z","data-logo-part":"text"}),d("path",{d:"M28.24.434c-4.956 0-9.372 3.413-10.625 7.8h1.795C20.457 4.968 24.012 2.1 28.24 2.1c5.14 0 9.582 3.882 9.582 9.925 0 1.356-.177 2.58-.513 3.66h1.743l.017-.059c.286-1.115.431-2.326.431-3.6 0-6.74-4.95-11.59-11.26-11.59z","data-logo-part":"accent"})]})),Dt=18;function Ot({iconHeight:e=Dt}){const{i18n:n}=s();return d(Lt,{className:$t.AffirmLogo,"aria-label":n.translate("shop_pay.affirm_title"),fill:Qe.toRgb(),height:e})}const Ut="CA";function Rt(){const{i18n:e}=s(),[n,t]=h(!1);return"US"===(null==(r=J().billingAddress.value)?void 0:r.countryCode)&&(null==r?void 0:r.zoneCode)===Ut?d(c,{children:[d(f,{display:"inline",padding:["none","none","none","small500"],children:d(oe,{onClick:()=>t(!0),children:e.translate("shop_pay.eligibility_details.title")})}),d(en,{heading:e.translate("shop_pay.eligibility_details.title"),open:n,onHide:()=>t(!1),children:d(_,{spacing:"large200",children:[d(v,{color:"subdued",children:e.translate("shop_pay.eligibility_details.legal_copy")}),d(b,{inlineSize:"fill",onClick:()=>t(!1),children:e.translate("shop_pay.checkout.close_notification")}),d(_,{inlineAlignment:"center",children:[d(nt,{color:"branded",size:"medium"}),d(v,{type:"small",color:"subdued",children:e.translate("shop_pay.pay_in_installments_affirm_partnership",{affirmLogo:d(Ot,{})})})]})]})})]}):null;var r}const zt=["en","bg-BG","cs","da","de","el","es","fi","fr","hi","hr-HR","hu","id","it","ja","ko","lt-LT","ms","nb","nl","pl","pt-BR","pt-PT","ro-RO","ru","sk-SK","sl-SI","sv","th","tr","vi","zh-CN","zh-TW"];function Ft(e){return zt.includes(e)}const jt=()=>{const e=s(),{loaded:n,error:t}=function(e){const n=p(document.querySelector(`script[src="${e}"]`)),[t,r]=h(Boolean(n.current)),[o,a]=h(!1);return m((()=>{if(!e)return;const t=e=>{"load"===e.type&&r(!0)},o=e=>{"error"===e.type&&a(!0)};return n.current||(n.current=document.createElement("script"),n.current.type="module",n.current.async=!0,n.current.src=e,document.body.appendChild(n.current)),n.current.addEventListener("load",t),n.current.addEventListener("error",o),()=>{var e,r;null===(e=n.current)||void 0===e||e.removeEventListener("load",t),null===(r=n.current)||void 0===r||r.removeEventListener("error",o)}}),[e]),{loaded:t,error:o}}(function({environment:e,telemetryClient:n,i18n:r}){const o=e.services.shopJS.url,a=function({locale:e,telemetryClient:n}){try{const t=new Intl.Locale(e);if(Ft(e))return e;if(Ft(t.language))return t.language;n.error(new he(`Unsupported locale: "${e}". Falling back to "en".`,{groupingHash:"ShopPayError::UnsupportedLocale"}))}catch(t){n.error(new he(`Invalid locale: "${e}". Falling back to "en".`,{groupingHash:"ShopPayError::InvalidLocale"}))}return"en"}({locale:r.locale,telemetryClient:n});return`${o}/modules/v2/loader.payment-terms.${a}.esm.js`}(e)),r=(()=>{var e;const{value:n}=nn(),t=null==n?void 0:n.presentmentCurrency,{shop:{countryCode:r},shopPay:o}=s(),a=null===(e=tn())||void 0===e?void 0:e.amount;if(0===o.installmentsFinancingPlans.length)return null;if("GB"===r)return null;const i=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e);let l,d,u=!1,c=4;const p=[];if(!a)return null;const h={SPLIT_PAY:"split_pay",INTEREST:"interest",ZERO_PERCENT:"zero_percent"},m=o.installmentsFinancingPlans.reduce(((e,n)=>{const{minPrice:t,terms:r}=n;return r.some((({loanType:e})=>"SPLIT_PAY"===e))?Math.min(e,parseFloat(t.amount)):e}),Number.MAX_SAFE_INTEGER),g=o.installmentsFinancingPlans.map((e=>{const{minPrice:n,maxPrice:t,terms:r}=e,o=parseFloat(n.amount),s=parseFloat(t.amount),c=Math.max(a,m);return l?o<l&&(l=o):l=o,d?s>d&&(d=s):d=s,a>=o&&a<=s&&(u=!0),c>=o&&c<=s&&p.push(...r.filter((({loanType:e})=>"SPLIT_PAY"===e))),{min_price:i(o),max_price:i(s),terms:r.map((e=>{const{apr:n,loanType:t,installmentsCount:r}=e;return{apr:n,loan_type:h[t],installments_count:r}}))}}));return p.length&&(c=p.reduce(((e,n)=>n.installmentsCount>e.installmentsCount?n:e),p[0]).installmentsCount),l&&d?{type:"checkout",currency_code:t,country_code:r,price_per_term:i(a/c),full_price:i(a),eligible:u,min_price:i(l),max_price:i(d),number_of_payment_terms:c,financing_plans:g,installments_buyer_prequalification_enabled:!1,seller_id:null}:null})(),o=rn();return t?null:n&&r?d("span",{className:"_1qn1o",children:d("shopify-payment-terms",{"shopify-meta":JSON.stringify(r),"show-new-buyer-incentive":o})}):null};var qt=(e=>(e.CheckoutOne="C1",e.Pay="PAY",e))(qt||{});const Ht=["initializePay","pingPay","updateAuthorization","updateCheckout","updateCard","setInitialUserState"];class Gt extends Error{constructor(...e){super(...e),r(this,"name","RPCConnectionTimeoutError")}}const Yt=1e3,Jt=100;function Vt(n,r,o){const[i,s]=h(!1),[d,u]=h(0),c=D((()=>{if(!r)return;const n=function(n,r){let{logging:o,messenger:a}=r,i=function(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==n.indexOf(r))continue;t[r]=e[r]}return t}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],-1===n.indexOf(t)&&{}.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}(r,e);return t(t({},on(null!=a?a:an(),i)),{},{id:i.uuid(),log(e,...n){}})}(qt.CheckoutOne,{callable:Ht,logging:!1,messenger:sn(r,{terminate:!1}),uuid:ln});return n.log(`expose initializeC1 ${d}`),n.expose({initializeC1(){}}),n}),[r,d]);m((()=>{if(!c)return void s(!1);const e={reset(){s(!1),u((e=>e+1))},closeModal(e,t){r("closeModal",arguments),n.onClose(e,t)},initializeC1(){return r("initializeC1",arguments),s(!0),{id:c.id,metadata:{timestamp:(new Date).toISOString()}}},installmentsError(e){r("installmentsError",arguments),n.onError(e)},payWithInstallments(e){r("payWithInstallments",arguments),n.onComplete(e)},pingC1(e="interrogative"){return r("pingC1",arguments),c.log(`PING: ${e} @ ${(new Date).toISOString()}`),n.onPing(e),`PONG: ${qt.CheckoutOne}`},resizeModal(e){return r("resizeModal",arguments),n.setHeight(e),window.innerHeight},updateProgress(e,t){r("updateProgress",arguments),n.onUpdateProgress(e,t)}};function r(e,n){null==c||c.log(e,n)}c.log("expose handlers"),c.expose(t({},e))}),[n,c]);const p=l((e=>e.initializePay()),[]),{connected:g,error:y}=function({rpcEndpoint:e,initializer:n,connectionOptions:{timeout:t=Yt,attemptDelay:r=Jt}={},inAppRPCSessionCount:o}){const[i,s]=h(!1),l=Ye(o),[d,u]=h(),c=e&&n&&!i&&!d;return m((()=>{l!==o&&s(!1)}),[o,l]),m((()=>{let t=!1;function i(){return(i=a((function*(){if(!e||!n||!c)return;const{call:a,log:i}=e;for(;;)try{i(`RPC channel ${o} opening...`);const e=yield n(a);if(!e){if(i("RPC channel not ready yet"),yield new Promise((e=>setTimeout(e,r))),t)break;continue}i("RPC channel opened",e),t||s(!0);break}catch(l){i("RPC connection failed",l),t||u(l);break}}))).apply(this,arguments)}return e&&n&&c&&(e.log("connection initiated"),function(){i.apply(this,arguments)}()),()=>{t=!0}}),[r,c,n,e,o]),m((()=>{if(!e||!c)return;let n=!1;const{log:r}=e,o=setTimeout((()=>{if(c){const e=new Gt("RPC channel open timeout");r("RPC connection failed",e),n||u(e)}}),t);return()=>{clearTimeout(o),n=!0}}),[c,e,t]),m((()=>(e||s(!1),()=>{e&&e.terminate()})),[e]),{connected:i,error:d}}({rpcEndpoint:c,initializer:i?p:void 0,connectionOptions:o,inAppRPCSessionCount:d});if(y)throw y;if(c&&i&&g)return c.call}const Wt="shop-pay-affirm-iframe";function Kt({checkoutDetails:e,open:n,onClose:r,onError:o,locale:a}){const i=pn(),[u,c]=h(null),[g,y]=h(),[b,C]=h(),[S,k]=h(null),[E,x]=h(!1),B=l((e=>{i.current&&y(e)}),[i]),M=p(),T=P.installmentsPayment.value,N=P.selectedPaymentMethod,$=w(N.value),L=A(),[O]=rt(),U=D((()=>({onClose(e,n){C(n),S||k(e),r()},setHeight(e){g&&(g.style.height=`${e}px`)},onComplete(e){P.installmentsPayment.value=e},onError:o,onUpdateProgress(e,n){const t=n?L.value.find((e=>Number(e.id)===(null==n?void 0:n.id))):null,r=t&&(null==n?void 0:n.id)!==Number(null==$?void 0:$.id),o=!t&&n;if(r)N.value=hn(t);else if(o){const e=(a=n,{lastUsedAt:"",name:"",id:String(a.id),brand:a.brand,expired:a.expired,expiring:!1,expiryMonth:a.month,expiryYear:a.year,funding:a.funding,lastDigits:a.last_digits,supportsInstallmentsInterestLoan:a.supports_installments_interest_loan,supportsInstallmentsSplitPayLoan:a.supports_installments_split_pay_loan,installmentsSplitPayLoanNotSupportedReason:a.installments_split_pay_loan_not_supported_reason,installmentsInterestLoanNotSupportedReason:a.installments_interest_loan_not_supported_reason,billingAddress:{address:{firstName:a.billing_address.first_name,lastName:a.billing_address.last_name,company:a.billing_address.company,address1:a.billing_address.address1,address2:a.billing_address.address2,city:a.billing_address.city,postalCode:a.billing_address.zip,phone:a.billing_address.phone,countryCode:a.billing_address.country_code,zoneCode:a.billing_address.zone_code}},billingAddressValid:a.address_valid}),t=hn(e);P.userStoredPaymentMethods.value=[...P.userStoredPaymentMethods.value,t],N.value=hn(e)}var a},onPing(e){"installments_iframe_loaded"===e&&c(!0)}})),[o,S,r,g,L.value,null==$?void 0:$.id,N]),R=function({open:e,lastKnownPayStepId:n,locale:r}){var o,a,i;const l=Wn(),{environment:{services:{shopServer:d}},shop:u,source:c,checkout:p,shopPay:{deviceFingerprint:g}}=s(),{myshopifyDomain:y,merchantPolicies:f,countryCode:v}=u,{checkoutSessionIdentifier:_}=c,b=P.selectedPaymentMethod.value,C=w(b),{pageLoadId:S}=te(c,p,u),[k,E]=h(null==C?void 0:C.id),x=I(),A=(null===(o=x.config)||void 0===o?void 0:o.availableLoanTypes.join(","))||"",B=null===(a=f.find((({handle:e})=>"refund-policy"===e)))||void 0===a?void 0:a.url,M=Je(),T=dn(),{tracking_unique:N,tracking_visit:$}=ee(),L=un(),O=rn();return m((()=>{!e&&C&&E(C.id)}),[C,e]),D((()=>{var e;if(!_||!k)return null;const o=(null===(e=x.config)||void 0===e?void 0:e.supportedCountries.join(","))||v,a={checkout_version:l,checkout_token:_,locale:r,parent_page_load_id:S,selected_card_id:k,shopify_domain:y,last_known_step_id:n,available_loan_types:A,refund_policy_url:B,isPointOfSale:M,supported_countries:o,tracking_unique:N,tracking_visit:$,variant_override:O?L:void 0,device_fingerprint:null!=g?g:""},i=(M?Object.entries(t(t({},a),T)):Object.entries(a)).map((([e,n=""])=>`${encodeURIComponent(e)}=${encodeURIComponent(n)}`)).join("&"),s=cn();return new URL(`/pay/transactions/${s?"installments_iframe_inapp":"installments_iframe"}?${i}`,d.url).href}),[_,k,null===(i=x.config)||void 0===i?void 0:i.supportedCountries,v,l,r,S,y,n,A,B,M,N,$,O,L,g,T,d.url])}({open:n,lastKnownPayStepId:b,locale:a}),z=Vt(U,g),{i18n:F,telemetryClient:j}=s();return tt({enabled:Boolean(g),onTimeout:()=>{u||(o(),c(!1))},timeout:6e3}),m((()=>{!e&&T||(M.current=void 0)}),[e,T]),m((()=>{z&&O&&z.updateAuthorization({accessToken:O})}),[z,O]),m((()=>{if(z&&e&&!T){var n;const r=null===(n=e.installmentsProposalData)||void 0===n||null===(n=n.taxAmount)||void 0===n?void 0:n.amount;var t;r||j.log("shop_pay_installments_tax_state_on_rpc_update_checkout","rpc.updateCheckout called with an invalid tax amount",{taxAmount:null===(t=e.installmentsProposalData)||void 0===t?void 0:t.taxAmount,taxAmountValue:r}),z.updateCheckout(e,M.current)}}),[e,T,z,j]),m((()=>{z&&null!=$&&$.id&&z.updateCard($.id)}),[z,null==$?void 0:$.id]),m((()=>{z&&S&&z.setInitialUserState(S)}),[z,S]),!1===u?d(gn,{open:E,size:"large",onHide:()=>{x(!1),r()},accessibilityLabel:F.translate("shop_pay.pay_in_installments_error_title"),children:d(f,{blockAlignment:"center",minBlockSize:200,children:d(_,{inlineAlignment:"center",spacing:"base",children:[d(mn,{level:2,textAlign:"center",children:F.translate("shop_pay.pay_in_installments_error_title")}),d(v,{textAlign:"center",children:F.translate("shop_pay.pay_in_installments_error_description")})]})})}):R?d(en,{accessibilityLabel:F.translate("shop_pay.pay_in_installments_title"),blocking:!0,iframeId:Wt,iframeRef:B,open:n,source:R}):null}function Xt(){var e,n,r;const{i18n:o,monorail:i,source:u,checkout:p,shop:g}=s(),y=yn(),{shopPayParts:f}=Z(),P=function(){const[e,n]=h(),[r,o]=h(!1),{value:a}=H(),i=function(){const e=Je(),{value:n}=Ve(),r=D((()=>null==n?void 0:n.lines.filter((({quantity:e})=>e>0))),[null==n?void 0:n.lines]),{value:o}=We("ONE_TIME_PURCHASE"),a=K(o),{shippingRequired:i}=T(),[s]=Ke(),l=Xe(e,a),d=function(e){const n=qe();return D((()=>{if(!e)return;const r=He(Ge,null==n?void 0:n.value),o=r?JSON.parse(r.value):void 0;return o?t(t({},o),{},{zoneCode:o.provinceCode,postalCode:o.zip}):void 0}),[n,e])}(e),{value:u}=X(),c=function(e){switch(null==e?void 0:e.status){case"available_total":return e.totalTax;case"available_total_included":return e.totalIncludedInTarget;default:return}}(u),{value:p}=H();return D((()=>{if(r)return{merchandiseLines:r,shippingAddress:i?null==s?void 0:s.address:void 0,shippingAmount:null==a?void 0:a.costAfterDiscounts,taxAmount:c,total:p,channel:e?Ze.RetailPos:Ze.Online,deliveryMethod:l,storeAddress:d}}),[e,a,s,i,p,c,r,l,d])}(),l=Ye(e),{locale:d}=s().i18n;return m((()=>{if(!a||!i)return void n(void 0);const t={format:"${{amount}}",decimal_mark:".",thousands_separator:","};if(!e)return void n({currencyFormat:t,installmentsProposalData:i,paymentDue:a,locale:d});const r=JSON.stringify(i)!==JSON.stringify(e.installmentsProposalData);r&&n({currencyFormat:t,installmentsProposalData:i,paymentDue:a,locale:d}),o(r)}),[e,i,a,d]),D((()=>({checkoutProposal:e,previousCheckoutProposal:l,hasChanged:r})),[e,l,r])}(),{telemetryClient:C,i18n:{locale:S}}=s(),{value:k,loading:E}=X(),{value:x}=fn(),A=vn(P,200),w=null==A||null===(e=A.checkoutProposal)||void 0===e?void 0:e.installmentsProposalData,B=et(),{setPayNowButtonElement:M}=Le(),N=I(),{progressContinue:$}=xt(),L=Pt(),O=$e(),{billingAddress:{countryCode:U}}=_n(),{data:R,loading:z}=ot(Tt,{variables:{countryCode:null!=U?U:""}}),{onInstallmentsError:F}=bn(),[j,q]=h(!1),G=null===(n=N.config)||void 0===n?void 0:n.availableLoanTypes,Y=f.internalProgressing,J=f.buttonProgressing,{progressing:V}=Te(),W=f.installmentsModalCloseForRetry,{locales:Q,default:ee}=null!==(r=null==R?void 0:R.installmentsSupportedLocales)&&void 0!==r?r:{default:"en"},ne=U?`${ee}-${U}`:ee,re=S.split("-")[0],oe=Boolean(null==Q?void 0:Q.includes(re)),ae=o.translate("general.continue_to_payment_plans_button_label"),ie=l((()=>q(!1)),[]),se=function(){var e=a((function*(){J.value=!0;try{if(yield $()){q(!0);const o=null==w?void 0:w.taxAmount,a=null==o,s=0===(null==o?void 0:o.amount);if(a||s){var e,n,r;const t=null!==(e=null==x?void 0:x.map((e=>e.code)))&&void 0!==e?e:[],i=t.includes("TAX_NEW_TAX_MUST_BE_ACCEPTED"),s=t.includes("PAYMENTS_UNACCEPTABLE_PAYMENT_AMOUNT");C.log("shop_pay_installments_tax_state_on_click","Installments CTA clicked while tax amount missing or zero",{taxState:a?"missing":"zero",taxes:k,taxesLoading:E,taxAmount:null!==(n=null==o?void 0:o.amount)&&void 0!==n?n:null,taxCurrency:null!==(r=null==o?void 0:o.currencyCode)&&void 0!==r?r:null,progressButtonDisabled:L,installmentsPaymentSet:Boolean(f.installmentsPayment.value),hasTaxViolation:i,hasPaymentAmountViolation:s,violationCodes:t})}i.record({schemaId:"shopify_pay_payment_page_ui_interaction/1.2",payload:t(t({},te(u,p,g)),{},{action:"continue_with_installments"})})}}finally{J.value=!1}}));return function(){return e.apply(this,arguments)}}();return m((()=>(Y.value=J.value||!O&&(V||j),()=>{Y.value=!1})),[Y,J.value,O,V,j]),m((()=>{null!=P&&P.hasChanged&&j&&ie()}),[null==P?void 0:P.hasChanged,j,ie]),m((()=>{W.value&&(W.value=!1,ie())}),[W,W.value,ie]),d(c,{children:[d(_,{children:[d("div",{className:B,children:d(b,{variant:"primary",loading:Y.value,disabled:L,inlineSize:"fill",onClick:se,ref:M,accessibilityLabel:ae,children:d(kt,{nextPageLabel:ae})})}),(()=>{if(z)return null;const e=Pn(G),n=Q&&!oe;return d(v,{type:"small",color:"subdued",children:[e&&"GB"!==U&&`${o.translate("shop_pay.installments_subject_to_eligibility")} `,(t=U,"GB"===t?o.translate("shop_pay.installments_partnership_affirm_gb",{affirmLogo:d(Ot,{})}):o.translate("shop_pay.installments_partnership_affirm",{affirmLogo:d(Ot,{})})),n&&` ${o.translate("shop_pay.installments_translations_disclaimer_with_supported_languages",{supportedLanguages:y(Nt(re,Q))})}`,d(Rt,{}),d(jt,{})]});var t})(),d(St,{}),d(Ct,{})]}),d(Kt,{checkoutDetails:null==A?void 0:A.checkoutProposal,open:j,onClose:ie,onError:F,locale:oe?S:ne})]})}const Zt={id:"74eb6a5d95353fd8e4a20f4a618cae958f59a4a82cef7d25d484f2dac3906204",type:"mutation",name:"BillingAgreementCreate",source:"mutation BillingAgreementCreate($creditCardId:ID!){billingAgreementCreate(creditCardId:$creditCardId){billingAgreementToken userErrors{field message __typename}__typename}}"},Qt={id:"b682b93574dca6b47b2b82ccff20c33939977942879c5e7d36142cedbc5dd3a5",type:"mutation",name:"PaymentMethodMutation",source:"mutation PaymentMethodMutation($addressId:ID,$creditCardId:ID!,$checkoutSessionIdentifier:String!,$shopifyDomain:String!,$installmentsParams:ShopPayExternalInstallmentsAgreementsInput){paymentMethodGenerate(addressId:$addressId creditCardId:$creditCardId checkoutIdentifier:$checkoutSessionIdentifier shopifyDomain:$shopifyDomain installmentsParams:$installmentsParams){userErrors{message field __typename}paymentMethod __typename}}"};let er=class extends Error{constructor(...e){super(...e),r(this,"name","ShopPayExternalMissingAddressIdError")}};const nr={id:"87d1f828736969404fc384e9a8ffa7af67a8649ad6464efd2d83b54796f38439",type:"mutation",name:"PaymentSessionMutation",source:"mutation PaymentSessionMutation($addressId:ID,$creditCardId:ID!,$checkoutSessionIdentifier:String!,$shopifyDomain:String!,$installmentsAgreements:InstallmentsAgreementsInput,$unvaultedShippingAddress:AddressInput,$checkoutClientSource:CheckoutClientSourceEnum,$batchCheckouts:[BatchCheckoutsInput!]){paymentSessionGenerate(addressId:$addressId creditCardId:$creditCardId checkoutIdentifier:$checkoutSessionIdentifier shopifyDomain:$shopifyDomain installmentsAgreements:$installmentsAgreements unvaultedShippingAddress:$unvaultedShippingAddress checkoutClientSource:$checkoutClientSource batchCheckouts:$batchCheckouts){userErrors{message field __typename}sessionId batchCheckoutSessionIds{sessionId shopId __typename}__typename}}"},tr={id:"b5cc4acfddca98abf067a251897e3ad93c0d11cb835539ddb2c2bbca106f7f43",type:"mutation",name:"PaymentSelectionCreateMutation",source:"mutation PaymentSelectionCreateMutation($addressId:ID,$creditCardId:ID!,$checkoutSessionIdentifier:String!,$shopifyDomain:String!,$installmentsParams:ShopPayExternalInstallmentsAgreementsInput){paymentSelectionCreate(addressId:$addressId creditCardId:$creditCardId checkoutIdentifier:$checkoutSessionIdentifier shopifyDomain:$shopifyDomain installmentsParams:$installmentsParams){userErrors{message field __typename}shopToken __typename}}"};class rr extends Error{constructor(...e){super(...e),r(this,"name","ShopPayExternalMissingAddressIdError")}}const or="No credit card selected on Credit Card payment method",ar=(e=[])=>e.some(Hn);class ir extends Error{constructor(...e){super(...e),r(this,"name","PaymentSessionError")}}class sr extends Error{constructor(){super("Phone required but not available"),r(this,"name","ShopPayPhoneFallbackUnavailableError")}}const lr=(e,n,r,o,a)=>!r.isRequiredByMerchant("phone",n)||e.phone?e:o?t(t({},e),{},{phone:o}):(a.error(new sr,{metadata:{billingCountry:{value:e.countryCode},countryForCheck:{value:n}}}),e),dr={FloatingShopPayButton:"TvbzE",FloatingShopPayButtonBuffer:"VaWCO",ButtonContainer:"HKMr7"};function ur({children:e}){const{panelRef:n,height:t}=Gn(e);return d(c,{children:[d("div",{style:{height:t},className:dr.FloatingShopPayButtonBuffer}),d("div",{id:"floating-shop-pay-button-container",style:{height:`${t}px`,bottom:0},className:dr.FloatingShopPayButton,children:d("div",{ref:n,className:dr.ButtonContainer,children:e})})]})}}}}))}();
