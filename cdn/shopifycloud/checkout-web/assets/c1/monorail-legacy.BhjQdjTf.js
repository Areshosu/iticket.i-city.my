!function(){function e(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function r(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?e(Object(i),!0).forEach((function(e){n(r,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))}))}return r}function n(e,r,n){return(r=function(e){var r=function(e){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof r?r:r+""}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}System.register(["./app-legacy.CVtZXpP_.js","./useShopPayPaymentRequiredMethod-legacy.DC5RFglA.js"],(function(e,n){"use strict";var t,i,o,s,a,l,d,c,u,p,h,_,y,g,S,f,C,b,m,v,O,A,P,E;return{setters:[e=>{t=e.s,i=e.ea,o=e.B,s=e.k,a=e.eb,l=e.D,d=e.ec,c=e.z,u=e.ed,p=e.ca,h=e.ee,_=e.dX,y=e.ef,g=e.n,S=e.eg,f=e.eh,C=e.ei,b=e.ej,m=e.bw,v=e.ek,O=e.i,A=e.el,P=e.em},e=>{E=e.u}],execute:function(){e({a:function(){return t.installmentsPrequalifiedAmount.value},d:function(){const{nonEligibleReason:e}=function(){const{hasOnlyEligibleMerchandiseItems:e,hasGiftCard:r}=function(){const{value:e}=p(),r=s((()=>{if(null==e||!e.lines)return{hasOnlyEligibleMerchandiseItems:!0,hasGiftCard:!1};let r=!1;return{hasOnlyEligibleMerchandiseItems:e.lines.every((e=>{const{requiresShipping:n,totalPrice:t,giftCard:i,title:o}=e;return i?(r=!0,!1):n||0===t.amount||function(e){const r=e.toLowerCase().replace(/[^\w\s+]/g,"").split(" ");for(const n of r)if(M.includes(n))return!0;return!1}(o)})),hasGiftCard:r}}),[null==e?void 0:e.lines]);return r}(),{value:n}=u(),{isCurrencySupported:t}=H(),i=!!n&&!t(null==n?void 0:n.currencyCode),o=s((()=>r?"PAYMENTS_SHOP_CASH_GIFT_CARD_NOT_ALLOWED":e?i?"PAYMENTS_SHOP_CASH_UNSUPPORTED_CURRENCY":null:"PAYMENTS_SHOP_CASH_UNSUPPORTED_SHIPPING"),[r,e,i]);return{eligible:null==o,nonEligibleReason:o}}(),{value:r,loading:n}=m(),{selectedShippingAddress:t,shippingAddressErrors:i,billingAddressErrors:o}=T(),a=o.size>0,l=i.size>0||t&&!n&&"unavailable"===(null==r?void 0:r.status),d=s((()=>e||(l?D.ShopCashInvalidShippingAddress:a?D.ShopCashInvalidBillingAddress:null)),[e,l,a]);return{eligible:null==d,nonEligibleReason:d}},f:T,g:function(e){return t.enabledFlags.value.includes(e)},u:function(){const e=i(),{pre_select_installments:r}=o(),n=s((()=>{const n=[];return e.isPointOfSale&&n.push(a.PointOfSale),r&&n.push(a.SpiBanner),e.preselectSpi&&n.push(e.preselectSpi),n}),[e.isPointOfSale,r,e.preselectSpi]),t=n.length>0;return{spiPreselected:t,preselectionReason:t?n.join(","):void 0}}});var n=e("C",(e=>(e.NewDebitCard="new_debit_card_form",e))(n||{})),I=e("i",(e=>(e.AddNew="credit_card_add_new",e))(I||{})),N=e("A",(e=>(e.NewShipping="shipping_address_add_new",e.NewBilling="billing_address_add_new",e))(N||{}));e("h",(()=>l(d)));const R=e("j",["SHOP_CASH_BALANCE","SHOP_DISCOUNT_OFFER","SHOP_PROMOTION"]);e("E",Object.fromEntries(R.map((e=>[e,null]))));var D=e("S",(e=>(e.ShopCashMerchantNotSupported="SHOP_CASH_MERCHANT_NOT_SUPPORTED",e.ShopCashInvalidShippingAddress="SHOP_CASH_INVALID_SHIPPING_ADDRESS",e.ShopCashInvalidBillingAddress="SHOP_CASH_INVALID_BILLING_ADDRESS",e.ShopCashInsufficientFundingLedgerBalance="INSUFFICIENT_FUNDING_LEDGER_BALANCE",e.ShopCashCheckoutNotReadyToFetch="SHOP_CASH_CHECKOUT_NOT_READY_TO_FETCH",e.ShopCashCreditCardVaultedRequired="CREDIT_CARD_VAULT_REQUIRED",e.ShopCashUnsupportedClient="SHOP_CASH_UNSUPPORTED_CLIENT",e))(D||{}));const w=[{currencyCode:"USD",countries:["US"]},{currencyCode:"CAD",countries:["CA"]}],H=(e("k","https://shop.app/shop-cash-terms"),e("e",(()=>{const e=s((()=>w.map((e=>e.currencyCode))),[]),r=c((r=>!!r&&e.includes(r)),[e]),n=s((()=>w.flatMap((e=>e.countries))),[]),t=c((e=>!!e&&n.includes(e)),[n]);return{supportedCurrencies:e,isCurrencySupported:r,supportedCountries:n,isCountrySupported:t}}))),M=["warranty","warranties","protect","protects","protection","protections","insurance","pickup","ship","shipping","delivery","deliveries","priority","priorities","rush","donation","donations","donate","donates","fee","fees","message","messages","coverage","coverages","guarantee","guarantees","tip","tips","gratuity","gratuities","tax","taxes","carbon","offset","return","returns","exchange","exchanges","tariff","tariffs","checkout+"];function T(){const e=h(),{shippingRequired:r}=_(),n=t.selectedPaymentMethod.value,i=y(n),o=g(),a=o.billingAddress.value,l=o.shippingAddress.value,d=S(),c=E(),u=C({paymentRequiredMethod:c,isIdealEnabledForShopPay:d}),p=f(),m=s((()=>p?t.selectedFreeCheckoutBillingAddress:u?t.selectedLPMBillingAddress:t.selectedNewCardBillingAddress),[p,u]).value,v=t.selectedShippingAddress.value,O=s((()=>r?null!=v&&v.address?v.address:l:null),[v,l,r]),A=b(null==O?void 0:O.countryCode,void 0,e),P=O?A(O,"shipping"):new Map,I=s((()=>i?i.billingAddress.address:null!=m&&m.address?m.address:"shipping"===o.billingAddressOption.value&&O?O:a),[i,m,o.billingAddressOption.value,O,a]),N=b(I.countryCode,void 0,e)(I,"billing");return{selectedBillingAddress:I,selectedShippingAddress:O,billingAddressErrors:N,shippingAddressErrors:P}}e("b",(()=>{const e=c((e=>Boolean(e.amount&&!isNaN(e.amount)&&e.amount>0&&e.currencyCode&&Boolean(v[e.currencyCode]))),[]),r=c((e=>"amount"in e&&"string"==typeof e.amount),[]),n=c((e=>r(e)?{amount:Number(e.amount),currencyCode:e.currencyCode}:{amount:Number(e.value),currencyCode:e.currency}),[r]),t=c((r=>{if(!r)return null;const t=n(r);return e(t)?t:null}),[n,e]),i=c((e=>({currency:e.currencyCode,value:e.amount.toString()})),[]),o=c((e=>{if(e)return i(e)}),[i]),s=c((e=>({currencyCode:e.currency,amount:e.value})),[]);return{toCoreMoney:n,toMaybeCoreMoney:t,toShopPayMoneyInput:i,toMaybeShopPayMoneyInput:o,toCoreMoneyInput:s,isValidCoreMoney:e}})),e("c",(()=>{const{monorail:e,source:n,checkout:t,shop:i}=O(),[o]=A(),a=s((()=>({publicId:o})),[o]),l=c((o=>e.record({schemaId:"shopify_pay_payment_page_shop_cash_redemption_visibility/1.1",payload:r(r(r({},P(n,t,i)),a),o)})),[e,n,t,i,a]),d=c((o=>e.record({schemaId:"shopify_pay_payment_page_shop_cash_redemption_eligibility/3.0",payload:r(r(r({},P(n,t,i)),a),o)})),[e,n,t,i,a]);return{recordRedemptionActionEvent:c((o=>e.record({schemaId:"shopify_pay_payment_page_shop_cash_redemption_actions/1.0",payload:r(r(r({},P(n,t,i)),a),o)})),[e,n,t,i,a]),recordRedemptionVisibilityEvent:l,recordRedemptionEligibilityEvent:d,recordRewardEligibilityEvent:c((o=>e.record({schemaId:"shopify_pay_payment_page_shop_cash_reward_eligibility/5.0",payload:r(r(r({},P(n,t,i)),a),o)})),[e,n,t,i,a]),recordUiInteractionEvent:c((o=>e.record({schemaId:"shopify_pay_payment_page_ui_interaction/1.1",payload:r(r({},P(n,t,i)),o)})),[e,n,t,i])}}))}}}))}();
