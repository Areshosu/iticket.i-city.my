!function(){function e(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function n(n){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?e(Object(i),!0).forEach((function(e){r(n,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))}))}return n}function r(e,n,r){return(n=function(e){var n=function(e){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof n?n:n+""}(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}System.register(["./app-legacy.CVtZXpP_.js"],(function(e,t){"use strict";var i,a,o,l,s,c,d,u,h,p,g,y,m,f,b,v,P,S,w,O,A,C,j,k,_,E,D,N,R,B,q,z,F,M,x,T,W,I,L,$,K,Y,G,H;return{setters:[e=>{i=e.cj,a=e.ck,o=e.aK,l=e.cl,s=e.k,c=e.i,d=e.cm,u=e.z,h=e.aM,p=e.aN,g=e.cn,y=e.co,m=e.a,f=e.aD,b=e.ar,v=e.as,P=e.cp,S=e.at,w=e.T,O=e.cq,A=e.cr,C=e.bG,j=e.cs,k=e.ct,_=e.cu,E=e.n,D=e.cv,N=e.aF,R=e.b2,B=e.cw,q=e.cx,z=e.cy,F=e.cz,M=e.cA,x=e.cB,T=e.cC,W=e.bf,I=e.W,L=e.ao,$=e.cD,K=e.cE,Y=e.bn,G=e.R,H=e.cF}],execute:function(){function t(){return i(new Set([...a].filter((e=>e.startsWith("DELIVERY_COMPANY")))))}function U({loading:e,countryCode:n,phone:r}){const t=o(),i=l(),a=s((()=>i.isRequired("phone",n)),[n,i]),{i18n:y}=c(),{validatePhoneNumber:m,isPhoneNumberUtilLoaded:f}=d(),b=u((e=>{const r=g(e);return a&&!r?y.translate("field_errors.phone_blank"):r&&!m(null!=e?e:"",n)?y.translate("field_errors.shipping_line_phone_invalid"):void 0}),[a,m,n,y]),v=h(!1);return p((()=>{if(v.current||!f||e)return;const n=b(r);t.value=n,v.current=!0}),[a,f,e,r,t,b]),s((()=>({errorSignal:t,validatePhoneField:b,isPhoneRequired:a})),[t,a,b])}function V(){const{hasError:e}=y(_),{i18n:n,telemetryClient:r}=c(),{isSdkAvailable:t,hasPaymentSheetErrorSignal:i,onClick:a,walletName:o}=J();return t?e?null:m(w,{children:m(f,{onClick:()=>{try{a()}catch(e){i.value=!0,r.error(new Q(`Error on changing buyer shipping address for wallet ${o}. Details: ${e}`,{cause:e}))}},children:m(b,{blockAlignment:"center",spacing:"none",children:[m(v,{type:"arrow-up-right",size:"small"}),m(P,{spacing:"small200"}),m(S,{children:n.translate("shipping.add_address")})]})})}):null}e("default",(function(){var e,n;const{i18n:r}=c(),{formattedAddress:i,address:{phone:a,countryCode:o}}=F(["company"]),l=!$(),{errorSignal:s}=U({loading:l,phone:a,countryCode:o}),d=Boolean(null===(e=t())||void 0===e?void 0:e.length),h=Boolean(null===(n=K())||void 0===n?void 0:n.length),g=Boolean(s.value),y=Boolean(h||d||g),[f,b]=N(!1);p((()=>{y&&b(!0)}),[y]);const S=u((()=>b((e=>!e))),[b]);return m(H,{id:"amazonPayDeliveryAddress",label:r.translate("shipping.shipping_address_title"),summary:l?m(Y,{}):m("div",{style:{display:"flex"},children:[y&&m(G,{children:[m(v,{tone:"critical",type:"alert-circle"}),m(P,{spacing:"small400"})]}),i]}),onToggle:S,open:f,children:m(l?Y:ee,{})})}));const J=()=>{const e=O()?A.BuyWithPrime:A.AmazonPay,{inMemoryAmazonPayParts:{hasPaymentSheetError:n,sdkStatus:r}}=C(),t=j(e),i=u((()=>{if(r.value.status!==k.Available)throw new Q(`SDK is not available for wallet ${e}`);(e===A.BuyWithPrime?r.value.sdk.buywithprime:r.value.sdk.Pay).changeShippingAddress({amazonCheckoutSessionId:t})}),[r,t,e]);return{isSdkAvailable:r.value.status===k.Available,hasPaymentSheetErrorSignal:n,onClick:i,walletName:e}};class Q extends Error{constructor(...e){super(...e),r(this,"name","ChangeAddressLinkError")}}function X({errorSignal:e,isRequired:r,validatePhoneField:t}){const{i18n:i}=c(),{shippingAddress:a}=E(),o=a.value,l=D(a.fields.phone,e,t),[s,d]=N(!1);if(R((()=>{e.value&&d(!0)})),!s)return null;const u=i.translate("contact.phone_label"),h=i.translate("contact.optional_phone_label");return m(w,{children:[m(w,{padding:"small400"}),m(B,n({name:"phone",countryCode:o.countryCode||"",label:r?u:h,hideCountries:!0,required:r,autocomplete:"shipping tel-national",autoFocus:!0},l))]})}function Z(){var e;const n=l(),{shippingAddress:r}=E(),[i]=null!==(e=t())&&void 0!==e?e:[],a=s((()=>q()),[]);return p((()=>{i&&(a.company.value=i)}),[a.company,i]),i?m(w,{children:[m(w,{padding:"small400"}),m(z,{address:r,addressErrors:a,addressType:"shipping",addressSettings:n,editDisabled:!1})]}):null}function ee(){const{formattedAddress:e,address:{firstName:n,lastName:r,phone:t,countryCode:i}}=F(["phone","firstName","lastName","company"]),{errorMessages:a,loading:o}=function(){const e=$();return{errorMessages:K(),loading:!e}}(),l=a.length>0,{errorSignal:s,validatePhoneField:c,isPhoneRequired:d}=U({loading:o,phone:t,countryCode:i});return m(I,{children:[l&&m(M,{}),m(x,{id:"restricted_address_edit",titleHidden:!0,selectedItems:["1"],onChange:()=>{},hideRadioButton:!0,children:m(T,{id:"1",children:m(W,{spacing:"base",blockAlignment:"start",children:m(I,{inlineAlignment:"start",cornerRadius:"base",padding:"none",children:m(w,{borderRadius:"base",children:[m(w,{padding:"none",children:[m(L,{children:[n," ",r]}),m(L,{color:"subdued",children:e})]}),m(Z,{}),m(X,{errorSignal:s,isRequired:d,validatePhoneField:c})]})})})})}),m(V,{})]})}}}}))}();
