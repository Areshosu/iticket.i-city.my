!function(){function e(e,n,t,i,r,o,l){try{var a=e[o](l),s=a.value}catch(e){return void t(e)}a.done?n(s):Promise.resolve(s).then(i,r)}function n(n){return function(){var t=this,i=arguments;return new Promise((function(r,o){var l=n.apply(t,i);function a(n){e(l,r,o,a,s,"next",n)}function s(n){e(l,r,o,a,s,"throw",n)}a(void 0)}))}}System.register(["./app-legacy.CVtZXpP_.js","./RemoteCheckoutLogo-legacy.BLIJpaJ3.js"],(function(e,t){"use strict";var i,r,o,l,a,s,c,d,u,m,h,g,p,x,f,v,b,y,_,k,w,z,T,I,S,C,N,D,R,A,M,O,L,P,U;return{setters:[e=>{i=e.u,r=e.b,o=e.a,l=e.T,a=e.P,s=e.d3,c=e.i,d=e.k,u=e.W,m=e.bf,h=e.ar,g=e.at,p=e.bg,x=e.a_,f=e.as,v=e.b5,b=e.ca,y=e.bT,_=e.d4,k=e.d5,w=e.d6,z=e.aF,T=e.d7,I=e.d8,S=e.aN,C=e.d1,N=e.ad,D=e.ae,R=e.cN,A=e.d9,M=e._,O=e.z,L=e.aZ,P=e.bh},e=>{U=e.R}],execute:function(){var t=document.createElement("style");t.textContent=".umM4O{position:absolute;display:flex;align-items:center}.DzMPD{z-index:3}.guTxx{transform:translate(calc(-100% + 4px));z-index:1;background-color:var(--x-default-color-border);-webkit-mask:linear-gradient(to left,white 3px,transparent 3px);mask:linear-gradient(to left,white 3px,transparent 3px)}.guTxx+.guTxx{transform:translate(calc(-200% + 8px));z-index:0}[dir=rtl] .guTxx{transform:translate(calc(100% - 4px));-webkit-mask:linear-gradient(to right,white 3px,transparent 3px);mask:linear-gradient(to right,white 3px,transparent 3px)}[dir=rtl] .guTxx+.guTxx{transform:translate(calc(200% - 8px));z-index:0}[dir=ltr] ._1yA8o{left:0}[dir=rtl] ._1yA8o{right:0}._1yA8o{position:fixed;z-index:9999;top:0;width:100dvw;height:100dvh;text-align:center;overflow-y:hidden;background-color:var(--x-default-color-background)}\n/*$vite$:1*/",document.head.appendChild(t),e("default",(function(){const{progress:e}=M(),{i18n:t,shop:{name:i}}=c(),r=$(),l=O(n((function*(){yield e("remote-merchandise-return-to-store")})),[e]),a=O((e=>()=>{window.open(e,"_blank")}),[]);return r.length?1===r.length?o(V,{remoteCheckoutDetails:r}):o(P,{id:"remote-merchandise-only-modal",open:!0,blocking:!0,heading:t.translate("remote_merchandise_only.title"),size:"large",children:o(u,{spacing:"loose",children:[o(g,{children:t.translate("remote_merchandise_only.remote_only_notice",{shop_name:i})}),o(u,{spacing:"loose",children:r.map((e=>o(B,{detail:e,onClickExternalCheckout:a(e.redirectUrl)},e.shopId)))}),o(u,{spacing:"base",children:[o(L,{}),o(x,{variant:"plain",textDecoration:"none",inlineSize:"fill",inlineAlignment:"center",onClick:l,children:o(g,{type:"mark",children:t.translate("remote_merchandise_only.return_to_store_label")})})]})]})}):null}));function q({src:e,alt:n,numberOfProducts:t}){const{global:{cornerRadius:s="base"},merchandiseThumbnail:{cornerRadius:c=s}}=i(),{blockSize:d,inlineSize:u}=r("small"),m=.9*d;return o(l,{minBlockSize:d,minInlineSize:u,cornerRadius:c,children:o("div",{className:"umM4O",children:[o(l,{className:"DzMPD",cornerRadius:c,children:o(a,{src:e,alt:n,size:"small"})}),t>=2&&o(l,{disableGlobalBranding:!0,className:"guTxx",cornerRadius:c,children:o(l,{disableGlobalBranding:!0,minBlockSize:m,minInlineSize:u,cornerRadius:c})})]})})}const B=({detail:{shopName:e,merchandiseItems:n,totalNumberOfMerchandiseItems:t,subtotal:i},onClickExternalCheckout:r})=>{const l=s({extraSmall:!1,base:!0}),{i18n:a}=c(),v=n.length?n[0].image:void 0,b=d((()=>i?a.formatCurrency(i.amount,{currency:i.currencyCode,form:"explicit"}):null),[i,a]);return n.length?o(m,{columns:["auto","fill","auto"],spacing:"base",children:[o(q,{src:(null==v?void 0:v.url)||"",alt:(null==v?void 0:v.altText)||"",numberOfProducts:n.length}),o(u,{spacing:"tight",children:[o(m,{columns:["fill","auto"],spacing:"base",children:[o(h,{spacing:"extraTight",children:[o(g,{children:a.translate("remote_merchandise_only.detail_item_label",{count:t})}),o(g,{children:p}),o(g,{children:e})]}),b&&o(g,{type:"strong",children:b})]}),o(x,{variant:"primary",size:"small",onClick:r,inlineSize:l?"fill":void 0,children:o(m,{columns:["1fr","auto"],spacing:"extraTight",blockAlignment:"center",children:[o(g,{children:a.translate("remote_merchandise_only.checkout_on_shop_label",{shop_name:e})}),o(f,{type:"external"})]})})]})]}):null},j=/^\$.remote.remote_negotiations\[(\d+)\]$/,$=()=>{const{shop:{remoteShopsConfigMap:e}}=c(),{value:n=[]}=v(),{value:t}=b(),{value:i}=y(),{value:r}=_(),{isMerchandiseRemote:o}=k(),l=d((()=>function({remoteMerchandiseDetails:e}){const n=null==e?void 0:e.stableIdToShopId;if(!n)return{};const t={};for(const[i,r]of n)t[r]?t[r].add(i):t[r]=new Set([i]);return t}({remoteMerchandiseDetails:i})),[i]),a=d((()=>Object.keys(l)),[l]),s=d((()=>n.filter((e=>"RedirectRequiredViolation"===e.__typename&&w(e)))),[n]),u=d((()=>function({remoteOnlyViolations:e,remoteShopIds:n}){const t={};for(const i of e){const e=j.exec(i.target);if(null==(null==e?void 0:e[1]))continue;const r=parseInt(e[1],10);if(isNaN(r))continue;const o=n[r];null!=o&&(t[o]=i.details[0])}return t}({remoteOnlyViolations:s,remoteShopIds:a})),[s,a]),m=d((()=>(null==t?void 0:t.lines.filter((e=>o(e.stableId))))||[]),[null==t?void 0:t.lines,o]);return d((()=>a.map((n=>{var t,i;const o=null==e?void 0:e.get(n),a=null==r||null===(t=r.perShopRemoteTotals.get(n))||void 0===t?void 0:t.subtotal,s=u[n],c=l[n],d=m.filter((e=>c.has(e.stableId))).map((e=>{var n,t;return{image:{url:(null===(n=e.image)||void 0===n?void 0:n.url)||"",altText:null===(t=e.image)||void 0===t?void 0:t.altText},quantity:e.quantity}})),h=d.reduce(((e,n)=>e+n.quantity),0)||0;return{shopId:n,shopName:(null==o?void 0:o.name)||"",subtotal:a,merchandiseItems:d,totalNumberOfMerchandiseItems:h,redirectUrl:s,shopLogoUrl:null==o||null===(i=o.brandSettings)||void 0===i||null===(i=i.squareLogo)||void 0===i?void 0:i.url}}))),[a,e,l,m,r,u])},E={Full:"_1yA8o"},F={firstLogoAnimationDuration:2500,secondLogoAnimationDuration:3300};function V({remoteCheckoutDetails:e}){var n;const{shopLogoUrl:t,shopName:i,shopId:r,redirectUrl:l}=null!==(n=null==e?void 0:e[0])&&void 0!==n?n:{},{i18n:a,shop:{name:s}}=c(),[d,u]=z(0),{lock:m}=T();return I((()=>{m()}),[m]),S((()=>{const e=window.setTimeout((()=>{u(1)}),F.firstLogoAnimationDuration),n=window.setTimeout((()=>{l&&window.location.assign(l)}),F.secondLogoAnimationDuration);return()=>{window.clearTimeout(e),window.clearTimeout(n)}}),[l]),o(C,{className:E.Full,children:o(N,{children:o(D,{children:o(R,{direction:"block",children:[o(A,{maxInlineSize:"300px",alignContent:"center",children:o(g,{type:"generic",size:"medium",children:a.translate("remote_merchandise_only.single_shop_transition",{advertiser:i,publisher:s,remote_shop:i})})}),o(R,{direction:"block",gap:"large-100",alignItems:"center",justifyContent:"center",paddingBlockStart:"large-400",children:[o(U,{shopName:i,status:0===d?"loading":"external",logoUrl:t,index:0,loadingIndex:d},r),o(g,{type:"generic",size:"small",children:i})]})]})})})})}}}}))}();
