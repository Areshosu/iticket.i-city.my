!function(){function e(e,t,n,r,a,l,i){try{var c=e[l](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function t(t){return function(){var n=this,r=arguments;return new Promise((function(a,l){var i=t.apply(n,r);function c(t){e(i,a,l,c,s,"next",t)}function s(t){e(i,a,l,c,s,"throw",t)}c(void 0)}))}}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./app-legacy.CVtZXpP_.js","./OffsitePaymentFailed-legacy.DPnP2OuQ.js"],(function(e,n){"use strict";var a,l,i,c,s,u,o,d,p,b,h,f,g,m,y,_,v,k,w,O,P,U,j,q,S,I,C,B,x,z,D,T,A,E,Q,F,L,W,H,M,N,X,$,G,J,K,R,V,Y,Z,ee,te,ne,re,ae,le,ie,ce,se,ue;return{setters:[e=>{a=e.i,l=e.b5,i=e.ca,c=e.es,s=e._,u=e.a0,o=e.n,d=e.cb,p=e.ch,b=e.dn,h=e.cd,f=e.ce,g=e.a5,m=e.k,y=e.aF,_=e.et,v=e.eu,k=e.a1,w=e.c8,O=e.z,P=e.a6,U=e.cf,j=e.aN,q=e.a2,S=e.a3,I=e.u,C=e.ev,B=e.bk,x=e.a,z=e.a_,D=e.ak,T=e.ar,A=e.as,E=e.at,Q=e.ap,F=e.aa,L=e.W,W=e.aX,H=e.ao,M=e.ad,N=e.ae,X=e.aS,$=e.cg,G=e.ah,J=e.bt,K=e.bq,R=e.br,V=e.bs,Y=e.bo,Z=e.bl,ee=e.P,te=e.S,ne=e.bp,re=e.aD,ae=e.aj,le=e.ab,ie=e.ew,ce=e.aU,se=e.bf},e=>{ue=e.C}],execute:function(){function n({merchandiseIssueType:e}){const{i18n:t}=a();return x(se,{columns:"auto",spacing:"small400",blockAlignment:"center",children:[x(A,{type:"disabled",tone:"critical",size:"small"}),x(ce,{children:(()=>{switch(e){case B.Unfulfillable:case B.Unavailable:return t.translate("contextual_availability.unavailable_label");case B.UnpurchasableB2B:return t.translate("stock.unpurchasable_product.status_column_header");case B.Unpurchasable:return t.translate("stock.unpurchasable_product_generic.status_column_header");case B.Unshippable:return t.translate("stock.unshippable_product.status_column_header");default:return t.translate("stock.sold_out_label")}})()})]})}function oe({quantity:e,previousQuantity:t}){return x(T,{spacing:"small200",children:[x(E,{color:"subdued",children:t}),x(E,{color:"subdued",children:"â†’"}),x(E,{type:"strong",children:e})]})}e("default",(function(){const{i18n:e,telemetryClient:ce,shop:se,url:de}=a(),{value:pe}=l(),{loading:be,value:he}=i(),fe=c(null!=pe?pe:[]),{progress:ge}=s(),{previousPage:me}=u(),ye=o().merchandiseLines,_e=d(),ve=p(),{value:ke}=b(),we=h(),Oe=f();g(Oe);const Pe=m((()=>{var e;return null!==(e=null==he?void 0:he.lines)&&void 0!==e?e:[]}),[he]),[Ue]=y(ye.value),je=_(Ue,pe),qe=v(Ue,Pe,pe),Se=k("draftOrder"),{hasStorefront:Ie}=se,Ce=w(),Be=ve.cartEmpty,xe=Be||!Ue?0:Ue.length,ze=Ie||xe>1,De=m((()=>Pe.reduce(((e,t)=>r(r({},e),{},{[t.stableId]:t})),{})),[Pe]),Te=O((()=>{const e=ye.peek();ye.value=e.flatMap((e=>{const t=De[e.stableId];return t?0===t.quantity||je.has(e.stableId)?[]:[r(r({},e),{},{quantity:t.quantity})]:[]}))}),[De,ye,je]),Ae=O((()=>{Te(),ge("stock-problems-submit")}),[ge,Te]),Ee=P(Oe,Ae),Qe=U(),Fe=O(t((function*(){yield Qe(ve.lineItems),window.location.replace(de.cart())})),[Qe,ve.lineItems,de]);j((()=>{_e.notify({checkout_in_progress:!1})}),[_e]),q({stage:be?S.Loading:S.Complete,id:"StockProblems"}),j((()=>we.listen((()=>{Te()}))),[we,Te]);const{stockProblemsLineItems:{spacing:Le="none"}}=I(),We=m((()=>fe===B.Unfulfillable?C([...je],ke):null),[ke,fe,je]),He=()=>{switch(fe){case B.Unavailable:return e.translate("contextual_availability.title",{count:qe.length});case B.UnpurchasableB2B:return e.translate("stock.unpurchasable_product.title");case B.Unpurchasable:return e.translate("stock.unpurchasable_product_generic.title");case B.QuantityChange:return e.translate("stock.quantity_update.title");case B.Unshippable:return e.translate("stock.unshippable_product.title");case B.Unfulfillable:return e.translate("stock.unfulfillable_product.title");default:return e.translate("stock.title")}},Me=!Ie||Ce&&Be?null:x(D,{children:x(z,{variant:"primary",size:"large",inlineSize:"fill",onClick:Ee,loading:be,children:Se||Be?e.translate("stock.return_to_store_label"):e.translate("general.continue_button_label")})}),Ne=Ie&&me.route&&!Ce&&!Be?x(Q,{children:x(z,{onClick:($e=t((function*(){yield Fe()})),function(){return $e.apply(this,arguments)}),variant:"plain",inlineSize:"fill",textDecoration:"none",children:x(T,{spacing:"small200",blockAlignment:"center",children:[x(A,{type:"chevron-left",size:"small"}),x(E,{children:e.translate("general.back_to_cart")})]})})}):null,Xe=()=>{switch(fe){case B.Unavailable:return Be?e.translate("contextual_availability.all_products_in_cart_unavailable",{count:qe.length}):e.translate("contextual_availability.products_not_available",{count:qe.length});case B.UnpurchasableB2B:return e.translate("stock.unpurchasable_product.message");case B.Unpurchasable:return e.translate("stock.unpurchasable_product_generic.message");case B.QuantityChange:return e.translate("stock.quantity_update.description");case B.Unshippable:return e.translate("stock.unshippable_product.message",{count:qe.length});case B.Unfulfillable:return We?e.translate("stock.unfulfillable_product.message",{delivery_method:We,count:qe.length}):(ce.error(new ie),e.translate("stock.unfulfillable_product.default_message",{count:qe.length}));default:return e.translate("stock.items_unavailable_notice")}};var $e;return x(le,{section:"stock-problems",children:[x(F,{children:He()}),x(L,{spacing:"large500",children:[x(ue,{status:"warning",children:[x(W,{children:(()=>{switch(fe){case B.UnpurchasableB2B:return e.translate("stock.unpurchasable_product.header");case B.Unpurchasable:return e.translate("stock.unpurchasable_product_generic.header");case B.Unshippable:return e.translate("stock.unshippable_product.header",{count:qe.length});case B.Unfulfillable:return e.translate("stock.unfulfillable_product.title");default:return He()}})()}),x(H,{color:"subdued",children:Xe()})]}),x(M,{children:[qe.length>0?x(N,{children:x(X,{children:x($,{message:Xe(),errorType:G.InventoryError,children:x(J,{titleHidden:!0,border:"outer",spacing:Le,title:fe===B.QuantityChange?e.translate("stock.quantity_update.page_title"):He(),children:[x(K,{blockPadding:"base",children:[x(R,{hidden:!0,children:e.translate("order_summary.product_image_label")}),x(R,{primary:!0,children:x(E,{type:"strong",children:e.translate("order_summary.description_label")})}),x(R,{hidden:fe!==B.OutOfStock,children:x(E,{type:"strong",children:fe===B.OutOfStock?e.translate("order_summary.quantity_label"):e.translate("order_summary.description_label")})})]}),x(V,{children:qe.map((({proposed:t,negotiated:r})=>{const a=null!=r?r:t,l=null==t?void 0:t.quantity,i=null==r?void 0:r.quantity,{stableId:c,image:s,title:u}=a;return x(Y,{spacing:"base",blockPadding:"base",children:[x(Z,{children:x(ee,{source:s?te.default(s.one).when({resolution:1},s.one).when({resolution:2},s.two).when({resolution:4},s.four):void 0,alt:u})}),x(Z,{primary:!0,children:x(ne,{id:null,deferredAmount:a.deferredAmount,options:a.options,properties:a.properties,quantity:a.quantity,recurringTotal:a.recurringTotal,sellingPlan:a.sellingPlan,subtitle:a.subtitle,title:u,totalPrice:a.totalPrice})}),x(Z,{noWrap:!0,children:null!=i&&i>0&&!je.has(c)?x(L,{inlineAlignment:"end",spacing:"small400",children:[x(oe,{quantity:i,previousQuantity:null!=l?l:0}),ze?x(re,{id:`remove-${c}`,onClick:()=>(e=>{const t=ye.peek();ye.value=t.filter((({stableId:t,quantity:n})=>t!==e&&n>0)),ge("stock-problems-remove-item")})(c),children:e.translate("stock.remove")}):null]}):x(n,{merchandiseIssueType:fe})})]},c)}))})]})})})}):null,Me||Ne?x(ae,{children:[Me,Ne]}):null]})]})]})}))}}}))}();
